# IMPROVEMENT: 流入経路デフォルト値改善

**作成日**: 2025年6月30日  
**分類**: Improvement - UX  
**影響範囲**: 顧客管理機能  
**優先度**: Medium  

---

## 🎯 改善要件

流入経路が全てデフォルト「紹介」になっているため、より適切なデフォルト値「アウトバウンド」への変更が必要。

### **現在の問題**
- 全ての流入経路が「紹介」でデフォルト設定
- 実際の流入経路との乖離
- データ分析の精度低下

### **改善提案**
- デフォルト値を「アウトバウンド」に変更
- より現実的な流入経路設定
- 営業活動の実態に即した設定

---

## 🔍 技術的調査項目

### **現在の実装確認**
1. **フォーム設定**
   - 顧客登録フォームのデフォルト値
   - 流入経路選択UIの実装

2. **データベース設定**
   - 流入経路カラムのデフォルト値
   - 既存データの状況確認

3. **API実装**
   - 顧客作成時のデフォルト値処理
   - 流入経路オプションの管理

---

## 🎯 実装計画

### **Phase 1: 現状確認**
- [ ] 流入経路の選択肢一覧確認
- [ ] 現在のデフォルト値設定確認
- [ ] 既存データの分布確認

### **Phase 2: 設定変更**
- [ ] フォームデフォルト値の変更
- [ ] データベースデフォルト値の更新
- [ ] API処理の修正

### **Phase 3: データ更新**
- [ ] 既存データの見直し（必要な場合）
- [ ] データ整合性の確認

### **Phase 4: テスト・検証**
- [ ] 新規顧客登録でのデフォルト値確認
- [ ] 流入経路選択動作の確認

---

**流入経路オプション（推定）**
- アウトバウンド（新デフォルト）
- 紹介（旧デフォルト）
- ウェブサイト
- SNS
- 展示会
- その他

**関連ファイル**: 
- `src/components/CustomerForm/`
- `src/app/api/customers/`
- `src/types/customer.ts`
- `prisma/schema.prisma`

**ステータス**: 解決済み  
**担当**: Claude Code Assistant  
**完了日**: 2025年6月30日

---

## 🎯 解決内容

### **実施した変更**
1. **データベーススキーマ修正**
   - `prisma/schema.prisma` の `appointment_details.sourceType` のデフォルト値を `REFERRAL` から `COLD_OUTREACH` に変更

2. **UI表示順序の調整**
   - `src/lib/types/kanban-types.ts` の `source` カンバンビューで `COLD_OUTREACH` を最初に表示し、タイトルを「アウトバウンド」に変更

3. **データベースマイグレーション実行**
   - `npx prisma db push` でスキーマ変更をデータベースに反映

### **変更による効果**
- ✅ 新しいアポイントメント作成時のデフォルト流入経路が「アウトバウンド」になる
- ✅ より現実的な営業活動に即したデフォルト設定
- ✅ データ分析の精度向上
- ✅ ユーザビリティの改善

### **技術的詳細**
- Prismaスキーマの `appointment_source` enum は変更なし（既存値維持）
- `appointment_details` テーブルの新規レコード作成時のみ影響
- 既存データへの影響なし