# ğŸ“‹ Phase 2: æˆ¦ç•¥çš„æ©Ÿèƒ½å®Ÿè£… è©³ç´°è¨ˆç”»æ›¸

## ğŸ¯ Phase 2 æ¦‚è¦

**æœŸé–“**: 4é€±é–“ï¼ˆ20å–¶æ¥­æ—¥ï¼‰  
**å·¥æ•°**: 18æ—¥  
**æ‹…å½“è€…**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ 1å + ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ 0.5å  
**é–‹å§‹æ¡ä»¶**: Phase 1å®Œäº†ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯åé›†å®Œäº†  
**å®Œäº†æ¡ä»¶**: 3ã¤ã®æˆ¦ç•¥æ©Ÿèƒ½ãŒãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ç’°å¢ƒã§ç¨¼åƒã™ã‚‹ã“ã¨  

## ğŸ“Š Phase 2 ç›®æ¨™

### å®šé‡ç›®æ¨™
- **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç«‹ã¡ä¸Šã’åŠ¹ç‡**: 500%å‘ä¸Šï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ´»ç”¨ï¼‰
- **è²¡å‹™ãƒªã‚¹ã‚¯æ¤œçŸ¥ç‡**: 95%ä»¥ä¸Šï¼ˆæ—©æœŸã‚¢ãƒ©ãƒ¼ãƒˆï¼‰
- **ãƒãƒ¼ãƒ ç”Ÿç”£æ€§**: 300%å‘ä¸Šï¼ˆMBTIæœ€é©åŒ–ï¼‰
- **ã‚·ã‚¹ãƒ†ãƒ å®Œæˆåº¦**: 70%é”æˆï¼ˆ109APIä¸­77å€‹æ´»ç”¨ï¼‰

### å®šæ€§ç›®æ¨™
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†ã®å®Œå…¨è‡ªå‹•åŒ–å®Ÿç¾
- äºˆé˜²çš„ãƒªã‚¹ã‚¯ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ æ§‹ç¯‰
- å€‹äººç‰¹æ€§ã«åŸºã¥ãæœ€é©åŒ–ã‚·ã‚¹ãƒ†ãƒ å®Ÿç¾
- ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºãƒ¬ãƒ™ãƒ«ã®æ©Ÿèƒ½æä¾›

## ğŸš€ å®Ÿè£…ã‚¿ã‚¹ã‚¯è©³ç´°

### ã‚¿ã‚¹ã‚¯ 2.1: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé©ç”¨ã‚·ã‚¹ãƒ†ãƒ 
**æœŸé–“**: 7å–¶æ¥­æ—¥  
**å·¥æ•°**: 7æ—¥  
**æ‹…å½“**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ + ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢  

#### ğŸ“‹ è¦ä»¶å®šç¾©
**æ©Ÿèƒ½è¦ä»¶**:
1. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé¸æŠãƒ»ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼UI
2. æ¥­ç•Œåˆ¥ãƒ»ç”¨é€”åˆ¥åˆ†é¡ã‚·ã‚¹ãƒ†ãƒ 
3. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ©Ÿèƒ½
4. æ—¢å­˜ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆåŒ–æ©Ÿèƒ½

**éæ©Ÿèƒ½è¦ä»¶**:
- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé©ç”¨æ™‚é–“: 30ç§’ä»¥å†…
- ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã‚ªãƒ—ã‚·ãƒ§ãƒ³: 10ç¨®é¡ä»¥ä¸Š
- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åæ˜ 

#### ğŸ—ï¸ å®Ÿè£…è©³ç´°

##### Day 1-2: ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé¸æŠãƒ»ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼UI
**ä½œæ¥­å†…å®¹**:
```typescript
// æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
/src/app/projects/templates/page.tsx
/src/app/projects/templates/components/TemplateSelector.tsx
/src/app/projects/templates/components/TemplatePreview.tsx
/src/hooks/useProjectTemplates.ts
```

**ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé¸æŠUIå®Ÿè£…**:
```typescript
// /src/hooks/useProjectTemplates.ts
export const useProjectTemplates = () => {
  const [templates, setTemplates] = useState([]);
  const [filteredTemplates, setFilteredTemplates] = useState([]);
  const [loading, setLoading] = useState(true);
  const [filters, setFilters] = useState({
    industry: 'ALL',
    complexity: 'ALL',
    technology: 'ALL',
    duration: 'ALL'
  });

  const fetchTemplates = useCallback(async () => {
    try {
      const response = await fetch('/api/project-templates');
      const data = await response.json();
      setTemplates(data.templates || []);
      setFilteredTemplates(data.templates || []);
    } catch (error) {
      console.error('Failed to fetch templates:', error);
    } finally {
      setLoading(false);
    }
  }, []);

  const generateTemplate = useCallback(async (requirements: ProjectRequirements) => {
    const response = await fetch('/api/project-templates', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(requirements)
    });
    return await response.json();
  }, []);

  const applyTemplate = useCallback(async (templateId: string, customizations: any) => {
    const response = await fetch('/api/projects/from-template', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ templateId, customizations })
    });
    return await response.json();
  }, []);

  useEffect(() => {
    fetchTemplates();
  }, [fetchTemplates]);

  useEffect(() => {
    let filtered = templates;
    
    if (filters.industry !== 'ALL') {
      filtered = filtered.filter(t => t.industry === filters.industry);
    }
    if (filters.complexity !== 'ALL') {
      filtered = filtered.filter(t => {
        const complexity = filters.complexity;
        if (complexity === 'LOW') return t.complexityLevel <= 3;
        if (complexity === 'MEDIUM') return t.complexityLevel >= 4 && t.complexityLevel <= 7;
        if (complexity === 'HIGH') return t.complexityLevel >= 8;
        return true;
      });
    }
    if (filters.technology !== 'ALL') {
      filtered = filtered.filter(t => 
        t.requiredTechnologies?.includes(filters.technology)
      );
    }
    if (filters.duration !== 'ALL') {
      filtered = filtered.filter(t => {
        const duration = filters.duration;
        if (duration === 'SHORT') return t.durationWeeksMax <= 4;
        if (duration === 'MEDIUM') return t.durationWeeksMax > 4 && t.durationWeeksMax <= 12;
        if (duration === 'LONG') return t.durationWeeksMax > 12;
        return true;
      });
    }
    
    setFilteredTemplates(filtered);
  }, [templates, filters]);

  return {
    templates: filteredTemplates,
    loading,
    filters,
    setFilters,
    generateTemplate,
    applyTemplate
  };
};

// /src/app/projects/templates/components/TemplateSelector.tsx
const TemplateSelector: React.FC = () => {
  const { templates, loading, filters, setFilters } = useProjectTemplates();
  const [selectedTemplate, setSelectedTemplate] = useState(null);
  const [showPreview, setShowPreview] = useState(false);

  const filterOptions = {
    industry: [
      { value: 'ALL', label: 'ã™ã¹ã¦' },
      { value: 'IT', label: 'ITãƒ»ã‚·ã‚¹ãƒ†ãƒ ' },
      { value: 'MARKETING', label: 'ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°' },
      { value: 'SALES', label: 'å–¶æ¥­' },
      { value: 'EDUCATION', label: 'æ•™è‚²' },
      { value: 'EVENT', label: 'ã‚¤ãƒ™ãƒ³ãƒˆ' },
      { value: 'CUSTOM', label: 'ã‚«ã‚¹ã‚¿ãƒ ' }
    ],
    complexity: [
      { value: 'ALL', label: 'ã™ã¹ã¦' },
      { value: 'LOW', label: 'ç°¡å˜ï¼ˆ1-3ï¼‰' },
      { value: 'MEDIUM', label: 'ä¸­ç¨‹åº¦ï¼ˆ4-7ï¼‰' },
      { value: 'HIGH', label: 'é«˜åº¦ï¼ˆ8-10ï¼‰' }
    ],
    technology: [
      { value: 'ALL', label: 'ã™ã¹ã¦' },
      { value: 'React', label: 'React' },
      { value: 'Node.js', label: 'Node.js' },
      { value: 'Python', label: 'Python' },
      { value: 'AI/ML', label: 'AI/ML' },
      { value: 'Mobile', label: 'ãƒ¢ãƒã‚¤ãƒ«' }
    ],
    duration: [
      { value: 'ALL', label: 'ã™ã¹ã¦' },
      { value: 'SHORT', label: 'çŸ­æœŸï¼ˆï½4é€±ï¼‰' },
      { value: 'MEDIUM', label: 'ä¸­æœŸï¼ˆ4-12é€±ï¼‰' },
      { value: 'LONG', label: 'é•·æœŸï¼ˆ12é€±ï½ï¼‰' }
    ]
  };

  const getComplexityColor = (level: number) => {
    if (level <= 3) return 'text-green-600 bg-green-100';
    if (level <= 7) return 'text-yellow-600 bg-yellow-100';
    return 'text-red-600 bg-red-100';
  };

  const getSuccessRateColor = (rate: number) => {
    if (rate >= 80) return 'text-green-600';
    if (rate >= 60) return 'text-yellow-600';
    return 'text-red-600';
  };

  if (loading) {
    return (
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {[...Array(6)].map((_, i) => (
          <div key={i} className="animate-pulse bg-gray-200 h-64 rounded-lg"></div>
        ))}
      </div>
    );
  }

  return (
    <div className="space-y-6">
      {/* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ */}
      <div className="bg-white p-6 rounded-lg shadow-md">
        <h3 className="text-lg font-semibold mb-4">ğŸ” ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ¤œç´¢</h3>
        <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
          {Object.entries(filterOptions).map(([key, options]) => (
            <div key={key}>
              <label className="block text-sm font-medium text-gray-700 mb-2">
                {key === 'industry' ? 'æ¥­ç•Œ' :
                 key === 'complexity' ? 'è¤‡é›‘åº¦' :
                 key === 'technology' ? 'æŠ€è¡“' : 'æœŸé–“'}
              </label>
              <select
                value={filters[key]}
                onChange={(e) => setFilters(prev => ({ ...prev, [key]: e.target.value }))}
                className="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"
              >
                {options.map(option => (
                  <option key={option.value} value={option.value}>
                    {option.label}
                  </option>
                ))}
              </select>
            </div>
          ))}
        </div>
      </div>

      {/* ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä¸€è¦§ */}
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {templates.map(template => (
          <div key={template.id} className="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow">
            <div className="p-6">
              <div className="flex items-start justify-between mb-4">
                <h3 className="text-lg font-semibold">{template.name}</h3>
                <div className="flex space-x-2">
                  <span className={`px-2 py-1 rounded text-xs font-medium ${getComplexityColor(template.complexityLevel)}`}>
                    é›£æ˜“åº¦ {template.complexityLevel}/10
                  </span>
                  {template.autoGenerated && (
                    <span className="px-2 py-1 rounded text-xs font-medium bg-purple-100 text-purple-800">
                      AIç”Ÿæˆ
                    </span>
                  )}
                </div>
              </div>

              <p className="text-gray-600 text-sm mb-4 line-clamp-3">
                {template.description}
              </p>

              <div className="space-y-2 mb-4">
                <div className="flex justify-between text-sm">
                  <span className="text-gray-500">æœŸé–“</span>
                  <span className="font-medium">
                    {template.durationWeeksMin}-{template.durationWeeksMax}é€±
                  </span>
                </div>
                <div className="flex justify-between text-sm">
                  <span className="text-gray-500">æˆåŠŸç‡</span>
                  <span className={`font-medium ${getSuccessRateColor(template.successRate)}`}>
                    {template.successRate}%
                  </span>
                </div>
                <div className="flex justify-between text-sm">
                  <span className="text-gray-500">ä½¿ç”¨å®Ÿç¸¾</span>
                  <span className="font-medium">{template.usageCount}å›</span>
                </div>
              </div>

              {template.requiredTechnologies?.length > 0 && (
                <div className="mb-4">
                  <div className="text-sm text-gray-500 mb-2">å¿…è¦æŠ€è¡“</div>
                  <div className="flex flex-wrap gap-1">
                    {template.requiredTechnologies.slice(0, 3).map((tech, index) => (
                      <span key={index} className="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded">
                        {tech}
                      </span>
                    ))}
                    {template.requiredTechnologies.length > 3 && (
                      <span className="px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded">
                        +{template.requiredTechnologies.length - 3}
                      </span>
                    )}
                  </div>
                </div>
              )}

              <div className="flex space-x-2">
                <button
                  onClick={() => {
                    setSelectedTemplate(template);
                    setShowPreview(true);
                  }}
                  className="flex-1 bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 text-sm"
                >
                  ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
                </button>
                <button
                  onClick={() => {
                    // ç›´æ¥é©ç”¨
                    window.location.href = `/projects/create?templateId=${template.id}`;
                  }}
                  className="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 text-sm"
                >
                  é©ç”¨
                </button>
              </div>
            </div>
          </div>
        ))}
      </div>

      {templates.length === 0 && (
        <div className="text-center py-12">
          <div className="text-gray-400 text-6xl mb-4">ğŸ“‹</div>
          <h3 className="text-lg font-medium text-gray-900 mb-2">
            è©²å½“ã™ã‚‹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒã‚ã‚Šã¾ã›ã‚“
          </h3>
          <p className="text-gray-500">
            ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¡ä»¶ã‚’å¤‰æ›´ã™ã‚‹ã‹ã€æ–°ã—ã„ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„
          </p>
        </div>
      )}

      {/* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ€ãƒ« */}
      {showPreview && selectedTemplate && (
        <TemplatePreview
          template={selectedTemplate}
          onClose={() => setShowPreview(false)}
          onApply={(customizations) => {
            // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé©ç”¨å‡¦ç†
            window.location.href = `/projects/create?templateId=${selectedTemplate.id}&customizations=${encodeURIComponent(JSON.stringify(customizations))}`;
          }}
        />
      )}
    </div>
  );
};
```

**å®Œäº†æ¡ä»¶**: ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä¸€è¦§ãŒè¡¨ç¤ºã•ã‚Œã€ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãƒ»ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒå‹•ä½œã™ã‚‹ã“ã¨

##### Day 3-4: ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ©Ÿèƒ½
**ä½œæ¥­å†…å®¹**:
```typescript
// /src/app/projects/templates/components/TemplatePreview.tsx
interface TemplatePreviewProps {
  template: ProjectTemplate;
  onClose: () => void;
  onApply: (customizations: TemplateCustomizations) => void;
}

const TemplatePreview: React.FC<TemplatePreviewProps> = ({
  template,
  onClose,
  onApply
}) => {
  const [customizations, setCustomizations] = useState<TemplateCustomizations>({
    projectName: '',
    description: '',
    startDate: new Date(),
    teamSize: template.targetScaleMin || 1,
    budget: template.budgetBreakdown?.total || 0,
    customPhases: template.phases,
    technologies: template.requiredTechnologies || [],
    riskToleranceLevel: 'MEDIUM'
  });

  const [activeTab, setActiveTab] = useState('overview');
  const [isApplying, setIsApplying] = useState(false);

  const handleApply = async () => {
    setIsApplying(true);
    try {
      await onApply(customizations);
    } catch (error) {
      toast.error('ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé©ç”¨ã«å¤±æ•—ã—ã¾ã—ãŸ');
    } finally {
      setIsApplying(false);
    }
  };

  const tabs = [
    { id: 'overview', label: 'æ¦‚è¦', icon: 'ğŸ“‹' },
    { id: 'phases', label: 'ãƒ•ã‚§ãƒ¼ã‚º', icon: 'ğŸ“Š' },
    { id: 'budget', label: 'äºˆç®—', icon: 'ğŸ’°' },
    { id: 'risks', label: 'ãƒªã‚¹ã‚¯', icon: 'âš ï¸' },
    { id: 'customize', label: 'ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º', icon: 'âš™ï¸' }
  ];

  return (
    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div className="bg-white rounded-lg w-full max-w-6xl h-5/6 overflow-hidden">
        {/* ãƒ˜ãƒƒãƒ€ãƒ¼ */}
        <div className="bg-gray-50 px-6 py-4 border-b flex items-center justify-between">
          <div>
            <h2 className="text-xl font-semibold">{template.name}</h2>
            <p className="text-gray-600 text-sm">{template.description}</p>
          </div>
          <button onClick={onClose} className="text-gray-400 hover:text-gray-600">
            <X className="w-6 h-6" />
          </button>
        </div>

        {/* ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */}
        <div className="border-b">
          <nav className="flex space-x-8 px-6">
            {tabs.map(tab => (
              <button
                key={tab.id}
                onClick={() => setActiveTab(tab.id)}
                className={`py-4 px-2 text-sm font-medium border-b-2 ${
                  activeTab === tab.id
                    ? 'border-blue-500 text-blue-600'
                    : 'border-transparent text-gray-500 hover:text-gray-700'
                }`}
              >
                <span className="mr-2">{tab.icon}</span>
                {tab.label}
              </button>
            ))}
          </nav>
        </div>

        {/* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ */}
        <div className="flex-1 overflow-y-auto p-6">
          {activeTab === 'overview' && (
            <div className="space-y-6">
              <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div className="bg-blue-50 p-4 rounded-lg">
                  <h3 className="font-semibold text-blue-800 mb-2">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¦æ¨¡</h3>
                  <p className="text-2xl font-bold text-blue-600">
                    {template.targetScaleMin}-{template.targetScaleMax}äºº
                  </p>
                </div>
                <div className="bg-green-50 p-4 rounded-lg">
                  <h3 className="font-semibold text-green-800 mb-2">äºˆæƒ³æœŸé–“</h3>
                  <p className="text-2xl font-bold text-green-600">
                    {template.durationWeeksMin}-{template.durationWeeksMax}é€±
                  </p>
                </div>
                <div className="bg-purple-50 p-4 rounded-lg">
                  <h3 className="font-semibold text-purple-800 mb-2">æˆåŠŸç‡</h3>
                  <p className="text-2xl font-bold text-purple-600">
                    {template.successRate}%
                  </p>
                </div>
              </div>

              <div>
                <h3 className="font-semibold mb-3">æˆåŠŸæŒ‡æ¨™ (KPI)</h3>
                <div className="space-y-2">
                  {template.successMetrics?.map((metric, index) => (
                    <div key={index} className="flex items-center">
                      <CheckCircle className="w-5 h-5 text-green-500 mr-2" />
                      <span>{metric}</span>
                    </div>
                  ))}
                </div>
              </div>

              <div>
                <h3 className="font-semibold mb-3">å¿…è¦ãƒªã‚½ãƒ¼ã‚¹</h3>
                <div className="bg-gray-50 p-4 rounded-lg">
                  <div className="grid grid-cols-2 gap-4">
                    <div>
                      <h4 className="font-medium mb-2">æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯</h4>
                      <div className="flex flex-wrap gap-2">
                        {template.requiredTechnologies?.map((tech, index) => (
                          <span key={index} className="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded">
                            {tech}
                          </span>
                        ))}
                      </div>
                    </div>
                    <div>
                      <h4 className="font-medium mb-2">å¿…è¦ã‚¹ã‚­ãƒ«</h4>
                      <div className="flex flex-wrap gap-2">
                        {template.resources?.requiredSkills?.map((skill, index) => (
                          <span key={index} className="px-2 py-1 bg-green-100 text-green-800 text-xs rounded">
                            {skill}
                          </span>
                        ))}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          )}

          {activeTab === 'phases' && (
            <div className="space-y-4">
              <h3 className="font-semibold">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚§ãƒ¼ã‚º</h3>
              {template.phases?.map((phase, index) => (
                <div key={index} className="border border-gray-200 rounded-lg p-4">
                  <div className="flex items-center justify-between mb-2">
                    <h4 className="font-medium">{phase.name}</h4>
                    <span className="text-sm text-gray-500">{phase.duration}</span>
                  </div>
                  <p className="text-gray-600 text-sm mb-3">{phase.description}</p>
                  
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                      <h5 className="font-medium text-sm mb-2">ä¸»è¦ã‚¿ã‚¹ã‚¯</h5>
                      <ul className="space-y-1">
                        {phase.tasks?.slice(0, 3).map((task, taskIndex) => (
                          <li key={taskIndex} className="text-sm text-gray-600 flex items-center">
                            <ArrowRight className="w-3 h-3 mr-2" />
                            {task}
                          </li>
                        ))}
                        {phase.tasks?.length > 3 && (
                          <li className="text-sm text-gray-500">
                            +{phase.tasks.length - 3}å€‹ã®ã‚¿ã‚¹ã‚¯
                          </li>
                        )}
                      </ul>
                    </div>
                    
                    <div>
                      <h5 className="font-medium text-sm mb-2">æˆæœç‰©</h5>
                      <ul className="space-y-1">
                        {phase.deliverables?.map((deliverable, delIndex) => (
                          <li key={delIndex} className="text-sm text-gray-600 flex items-center">
                            <FileText className="w-3 h-3 mr-2" />
                            {deliverable}
                          </li>
                        ))}
                      </ul>
                    </div>
                  </div>
                </div>
              ))}
            </div>
          )}

          {activeTab === 'budget' && (
            <div className="space-y-6">
              <h3 className="font-semibold">äºˆç®—å†…è¨³</h3>
              
              <div className="bg-gray-50 p-4 rounded-lg">
                <div className="text-center mb-4">
                  <div className="text-3xl font-bold text-green-600">
                    Â¥{template.budgetBreakdown?.total?.toLocaleString() || 0}
                  </div>
                  <div className="text-sm text-gray-600">ç·äºˆç®—</div>
                </div>
              </div>

              <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                {Object.entries(template.budgetBreakdown || {}).map(([category, amount]) => {
                  if (category === 'total') return null;
                  return (
                    <div key={category} className="border border-gray-200 rounded-lg p-4">
                      <div className="flex justify-between items-center">
                        <span className="font-medium capitalize">{category}</span>
                        <span className="text-lg font-semibold">
                          Â¥{amount?.toLocaleString()}
                        </span>
                      </div>
                      <div className="w-full bg-gray-200 rounded-full h-2 mt-2">
                        <div 
                          className="bg-blue-500 h-2 rounded-full"
                          style={{ 
                            width: `${((amount / template.budgetBreakdown?.total) * 100)}%` 
                          }}
                        ></div>
                      </div>
                      <div className="text-sm text-gray-500 mt-1">
                        {Math.round((amount / template.budgetBreakdown?.total) * 100)}% of total
                      </div>
                    </div>
                  );
                })}
              </div>
            </div>
          )}

          {activeTab === 'risks' && (
            <div className="space-y-4">
              <h3 className="font-semibold">ãƒªã‚¹ã‚¯åˆ†æ</h3>
              {template.riskFactors?.map((risk, index) => (
                <div key={index} className="border border-red-200 rounded-lg p-4">
                  <div className="flex items-start justify-between">
                    <div className="flex-1">
                      <h4 className="font-medium text-red-800">{risk.factor}</h4>
                      <p className="text-sm text-gray-600 mt-1">{risk.description}</p>
                    </div>
                    <div className="ml-4 text-center">
                      <div className="text-lg font-bold text-red-600">
                        {Math.round(risk.probability * 100)}%
                      </div>
                      <div className="text-xs text-gray-500">ç™ºç”Ÿç¢ºç‡</div>
                    </div>
                  </div>
                  
                  {risk.mitigation && (
                    <div className="mt-3 bg-green-50 p-3 rounded">
                      <h5 className="font-medium text-green-800 text-sm">å¯¾ç­–</h5>
                      <p className="text-sm text-green-700">{risk.mitigation}</p>
                    </div>
                  )}
                </div>
              ))}
            </div>
          )}

          {activeTab === 'customize' && (
            <div className="space-y-6">
              <h3 className="font-semibold">ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º</h3>
              
              <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå
                  </label>
                  <input
                    type="text"
                    value={customizations.projectName}
                    onChange={(e) => setCustomizations(prev => ({ 
                      ...prev, 
                      projectName: e.target.value 
                    }))}
                    className="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"
                    placeholder="ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã‚’å…¥åŠ›"
                  />
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    é–‹å§‹äºˆå®šæ—¥
                  </label>
                  <input
                    type="date"
                    value={format(customizations.startDate, 'yyyy-MM-dd')}
                    onChange={(e) => setCustomizations(prev => ({ 
                      ...prev, 
                      startDate: new Date(e.target.value) 
                    }))}
                    className="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"
                  />
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    ãƒãƒ¼ãƒ ã‚µã‚¤ã‚º
                  </label>
                  <input
                    type="number"
                    value={customizations.teamSize}
                    onChange={(e) => setCustomizations(prev => ({ 
                      ...prev, 
                      teamSize: parseInt(e.target.value) || 1 
                    }))}
                    min={template.targetScaleMin}
                    max={template.targetScaleMax}
                    className="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"
                  />
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    äºˆç®—
                  </label>
                  <input
                    type="number"
                    value={customizations.budget}
                    onChange={(e) => setCustomizations(prev => ({ 
                      ...prev, 
                      budget: parseInt(e.target.value) || 0 
                    }))}
                    className="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"
                    placeholder="äºˆç®—ã‚’å…¥åŠ›"
                  />
                </div>
              </div>

              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆèª¬æ˜
                </label>
                <textarea
                  value={customizations.description}
                  onChange={(e) => setCustomizations(prev => ({ 
                    ...prev, 
                    description: e.target.value 
                  }))}
                  rows={4}
                  className="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"
                  placeholder="ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®èª¬æ˜ã‚’å…¥åŠ›"
                />
              </div>

              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  ãƒªã‚¹ã‚¯è¨±å®¹åº¦
                </label>
                <select
                  value={customizations.riskToleranceLevel}
                  onChange={(e) => setCustomizations(prev => ({ 
                    ...prev, 
                    riskToleranceLevel: e.target.value as 'LOW' | 'MEDIUM' | 'HIGH' 
                  }))}
                  className="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"
                >
                  <option value="LOW">ä½ï¼ˆå®‰å…¨é‡è¦–ï¼‰</option>
                  <option value="MEDIUM">ä¸­ï¼ˆãƒãƒ©ãƒ³ã‚¹é‡è¦–ï¼‰</option>
                  <option value="HIGH">é«˜ï¼ˆã‚¹ãƒ”ãƒ¼ãƒ‰é‡è¦–ï¼‰</option>
                </select>
              </div>
            </div>
          )}
        </div>

        {/* ãƒ•ãƒƒã‚¿ãƒ¼ */}
        <div className="bg-gray-50 px-6 py-4 border-t flex items-center justify-between">
          <div className="text-sm text-gray-600">
            ã“ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¯{template.usageCount}å›ä½¿ç”¨ã•ã‚Œã€
            å¹³å‡æº€è¶³åº¦{template.averageSatisfaction}/5.0ã‚’ç²å¾—ã—ã¦ã„ã¾ã™
          </div>
          
          <div className="flex space-x-3">
            <button
              onClick={onClose}
              className="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"
            >
              ã‚­ãƒ£ãƒ³ã‚»ãƒ«
            </button>
            <button
              onClick={handleApply}
              disabled={isApplying || !customizations.projectName}
              className="px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50"
            >
              {isApplying ? 'é©ç”¨ä¸­...' : 'ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’é©ç”¨'}
            </button>
          </div>
        </div>
      </div>
    </div>
  );
};
```

**å®Œäº†æ¡ä»¶**: ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®è©³ç´°ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¨ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãŒå¯èƒ½ã«ãªã‚‹ã“ã¨

##### Day 5-6: æ¥­ç•Œåˆ¥ãƒ»ç”¨é€”åˆ¥åˆ†é¡ã‚·ã‚¹ãƒ†ãƒ ãƒ»ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé©ç”¨æ©Ÿèƒ½
**ä½œæ¥­å†…å®¹**:
```typescript
// /src/app/api/projects/from-template/route.ts (æ–°è¦ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰API)
import { NextRequest, NextResponse } from 'next/server';
import { prisma } from '@/lib/prisma';
import { ProjectTemplateGenerator } from '@/services/ProjectTemplateGenerator';

export async function POST(request: NextRequest) {
  try {
    const { templateId, customizations } = await request.json();

    // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå–å¾—
    const template = await prisma.projectTemplate.findUnique({
      where: { id: templateId }
    });

    if (!template) {
      return NextResponse.json(
        { error: 'Template not found' },
        { status: 404 }
      );
    }

    // ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã‚ŒãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
    const projectData = {
      name: customizations.projectName,
      description: customizations.description,
      startDate: new Date(customizations.startDate),
      targetEndDate: new Date(
        new Date(customizations.startDate).getTime() + 
        (template.durationWeeksMax * 7 * 24 * 60 * 60 * 1000)
      ),
      
      // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰ç¶™æ‰¿
      phases: customizations.customPhases || template.phases,
      kgi: template.successMetrics?.[0] || '',
      priority: 'HIGH',
      status: 'PLANNING',
      complexityLevel: template.complexityLevel,
      
      // ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºåæ˜ 
      budget: customizations.budget,
      teamSize: customizations.teamSize,
      riskToleranceLevel: customizations.riskToleranceLevel,
      
      // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
      templateId: template.id,
      autoGenerated: true,
      templateAppliedAt: new Date()
    };

    // ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
    const project = await prisma.project.create({
      data: {
        ...projectData,
        createdBy: 'system', // TODO: å®Ÿéš›ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã‚’è¨­å®š
      }
    });

    // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰ã‚¿ã‚¹ã‚¯è‡ªå‹•ç”Ÿæˆ
    await generateTasksFromTemplate(project.id, template, customizations);

    // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä½¿ç”¨å›æ•°æ›´æ–°
    await prisma.projectTemplate.update({
      where: { id: templateId },
      data: { usageCount: { increment: 1 } }
    });

    return NextResponse.json({
      success: true,
      project: {
        id: project.id,
        name: project.name,
        status: project.status
      }
    });

  } catch (error) {
    console.error('Error applying template:', error);
    return NextResponse.json(
      { error: 'Failed to apply template' },
      { status: 500 }
    );
  }
}

async function generateTasksFromTemplate(
  projectId: string, 
  template: any, 
  customizations: any
) {
  const tasks = [];
  
  // å„ãƒ•ã‚§ãƒ¼ã‚ºã‹ã‚‰ã‚¿ã‚¹ã‚¯ç”Ÿæˆ
  for (const phase of template.phases || []) {
    for (const taskTemplate of phase.tasks || []) {
      tasks.push({
        title: taskTemplate,
        description: `${phase.name}ãƒ•ã‚§ãƒ¼ã‚º: ${taskTemplate}`,
        projectId,
        status: 'TODO',
        priority: 'MEDIUM',
        phase: phase.name,
        estimatedHours: Math.ceil(Math.random() * 8) + 1, // æš«å®šå€¤
        startDate: new Date(), // TODO: ãƒ•ã‚§ãƒ¼ã‚ºã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‹ã‚‰è¨ˆç®—
        dueDate: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000), // 1é€±é–“å¾Œ
        autoGenerated: true,
        templateId: template.id
      });
    }
  }

  // ãƒãƒƒãƒã§ã‚¿ã‚¹ã‚¯ä½œæˆ
  if (tasks.length > 0) {
    await prisma.task.createMany({
      data: tasks
    });
  }
}

// /src/app/projects/create/page.tsx ã®æ‹¡å¼µ
const CreateProjectPage: React.FC = () => {
  const searchParams = useSearchParams();
  const templateId = searchParams.get('templateId');
  const customizationsParam = searchParams.get('customizations');
  
  const [isFromTemplate, setIsFromTemplate] = useState(!!templateId);
  const [template, setTemplate] = useState(null);
  const [customizations, setCustomizations] = useState(null);

  useEffect(() => {
    if (templateId) {
      fetchTemplate();
    }
    if (customizationsParam) {
      try {
        const parsed = JSON.parse(decodeURIComponent(customizationsParam));
        setCustomizations(parsed);
      } catch (error) {
        console.error('Failed to parse customizations:', error);
      }
    }
  }, [templateId, customizationsParam]);

  const fetchTemplate = async () => {
    try {
      const response = await fetch(`/api/project-templates/${templateId}`);
      const data = await response.json();
      setTemplate(data.template);
    } catch (error) {
      console.error('Failed to fetch template:', error);
    }
  };

  const handleCreateFromTemplate = async () => {
    try {
      const response = await fetch('/api/projects/from-template', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          templateId,
          customizations
        })
      });

      const result = await response.json();
      
      if (result.success) {
        toast.success('ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒä½œæˆã•ã‚Œã¾ã—ãŸï¼');
        router.push(`/projects/${result.project.id}`);
      } else {
        throw new Error(result.error);
      }
    } catch (error) {
      toast.error('ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ');
      console.error('Failed to create project:', error);
    }
  };

  if (isFromTemplate && template) {
    return (
      <div className="container mx-auto px-4 py-8">
        <div className="mb-8">
          <h1 className="text-3xl font-bold">ğŸš€ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ</h1>
          <p className="text-gray-600 mt-2">
            ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã€Œ{template.name}ã€ã‹ã‚‰ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™
          </p>
        </div>

        <div className="bg-white rounded-lg shadow-md p-6">
          <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <div>
              <h2 className="text-xl font-semibold mb-4">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®š</h2>
              {/* ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãƒ•ã‚©ãƒ¼ãƒ  */}
              <ProjectCustomizationForm 
                template={template}
                initialCustomizations={customizations}
                onChange={setCustomizations}
              />
            </div>
            
            <div>
              <h2 className="text-xl font-semibold mb-4">ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè©³ç´°</h2>
              <TemplateDetailsSummary template={template} />
            </div>
          </div>

          <div className="mt-8 flex justify-between">
            <button
              onClick={() => router.push('/projects/templates')}
              className="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"
            >
              â† ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé¸æŠã«æˆ»ã‚‹
            </button>
            
            <button
              onClick={handleCreateFromTemplate}
              className="px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600"
            >
              ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
            </button>
          </div>
        </div>
      </div>
    );
  }

  // æ—¢å­˜ã®é€šå¸¸ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆUI...
  return <ExistingCreateProjectForm />;
};
```

**å®Œäº†æ¡ä»¶**: ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨ã‚¿ã‚¹ã‚¯ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ã“ã¨

##### Day 7: æ—¢å­˜ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆåŒ–æ©Ÿèƒ½ãƒ»çµ±åˆãƒ†ã‚¹ãƒˆ
**ä½œæ¥­å†…å®¹**:
```typescript
// /src/app/api/project-templates/from-project/route.ts (æ–°è¦)
export async function POST(request: NextRequest) {
  try {
    const { projectId, templateName, templateDescription, isPublic } = await request.json();

    // ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå–å¾—
    const project = await prisma.project.findUnique({
      where: { id: projectId },
      include: {
        tasks: true,
        financialDetails: true
      }
    });

    if (!project) {
      return NextResponse.json(
        { error: 'Project not found' },
        { status: 404 }
      );
    }

    // ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰æ±ç”¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆ
    const templateGenerator = new ProjectTemplateGenerator();
    const templateData = await templateGenerator.generateFromExistingProject(project, {
      name: templateName,
      description: templateDescription,
      isPublic
    });

    const template = await prisma.projectTemplate.create({
      data: {
        ...templateData,
        sourceProjectId: projectId,
        autoGenerated: false, // æ‰‹å‹•ä½œæˆ
        createdBy: 'user' // TODO: å®Ÿéš›ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ID
      }
    });

    return NextResponse.json({
      success: true,
      template: {
        id: template.id,
        name: template.name
      }
    });

  } catch (error) {
    console.error('Error creating template from project:', error);
    return NextResponse.json(
      { error: 'Failed to create template' },
      { status: 500 }
    );
  }
}

// /src/app/projects/[id]/page.tsx ã«ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆåŒ–ãƒœã‚¿ãƒ³è¿½åŠ 
const ProjectDetailPage = ({ params }) => {
  const [showTemplateModal, setShowTemplateModal] = useState(false);

  const handleCreateTemplate = async (templateData) => {
    try {
      const response = await fetch('/api/project-templates/from-project', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          projectId: params.id,
          ...templateData
        })
      });

      const result = await response.json();
      
      if (result.success) {
        toast.success('ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒä½œæˆã•ã‚Œã¾ã—ãŸï¼');
        setShowTemplateModal(false);
      }
    } catch (error) {
      toast.error('ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ');
    }
  };

  return (
    <div className="container mx-auto px-4 py-8">
      {/* æ—¢å­˜ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè©³ç´°ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */}
      
      {/* æ–°è¦: ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢ */}
      <div className="mt-8 flex space-x-4">
        <button
          onClick={() => setShowTemplateModal(true)}
          className="bg-purple-500 text-white px-4 py-2 rounded-lg hover:bg-purple-600 flex items-center"
        >
          <Template className="w-4 h-4 mr-2" />
          ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆåŒ–
        </button>
      </div>

      {/* ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä½œæˆãƒ¢ãƒ¼ãƒ€ãƒ« */}
      {showTemplateModal && (
        <CreateTemplateModal
          project={project}
          onClose={() => setShowTemplateModal(false)}
          onSubmit={handleCreateTemplate}
        />
      )}
    </div>
  );
};

// /src/components/modals/CreateTemplateModal.tsx
const CreateTemplateModal: React.FC<{
  project: Project;
  onClose: () => void;
  onSubmit: (data: any) => void;
}> = ({ project, onClose, onSubmit }) => {
  const [formData, setFormData] = useState({
    templateName: `${project.name} ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ`,
    templateDescription: `${project.name}ã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ`,
    isPublic: false,
    includeFinancialData: true,
    includeTaskDetails: true,
    anonymizeData: true
  });

  const handleSubmit = (e) => {
    e.preventDefault();
    onSubmit(formData);
  };

  return (
    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div className="bg-white rounded-lg w-full max-w-md p-6">
        <h2 className="text-xl font-semibold mb-4">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä½œæˆ</h2>
        
        <form onSubmit={handleSubmit} className="space-y-4">
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">
              ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå
            </label>
            <input
              type="text"
              value={formData.templateName}
              onChange={(e) => setFormData(prev => ({ 
                ...prev, 
                templateName: e.target.value 
              }))}
              className="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500"
              required
            />
          </div>

          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">
              èª¬æ˜
            </label>
            <textarea
              value={formData.templateDescription}
              onChange={(e) => setFormData(prev => ({ 
                ...prev, 
                templateDescription: e.target.value 
              }))}
              rows={3}
              className="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500"
              required
            />
          </div>

          <div className="space-y-2">
            <div className="flex items-center">
              <input
                type="checkbox"
                id="isPublic"
                checked={formData.isPublic}
                onChange={(e) => setFormData(prev => ({ 
                  ...prev, 
                  isPublic: e.target.checked 
                }))}
                className="rounded border-gray-300 text-purple-600 focus:ring-purple-500"
              />
              <label htmlFor="isPublic" className="ml-2 text-sm text-gray-700">
                ä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨å…±æœ‰ã™ã‚‹
              </label>
            </div>

            <div className="flex items-center">
              <input
                type="checkbox"
                id="includeFinancialData"
                checked={formData.includeFinancialData}
                onChange={(e) => setFormData(prev => ({ 
                  ...prev, 
                  includeFinancialData: e.target.checked 
                }))}
                className="rounded border-gray-300 text-purple-600 focus:ring-purple-500"
              />
              <label htmlFor="includeFinancialData" className="ml-2 text-sm text-gray-700">
                äºˆç®—ãƒ»è²¡å‹™ãƒ‡ãƒ¼ã‚¿ã‚’å«ã‚ã‚‹
              </label>
            </div>

            <div className="flex items-center">
              <input
                type="checkbox"
                id="anonymizeData"
                checked={formData.anonymizeData}
                onChange={(e) => setFormData(prev => ({ 
                  ...prev, 
                  anonymizeData: e.target.checked 
                }))}
                className="rounded border-gray-300 text-purple-600 focus:ring-purple-500"
              />
              <label htmlFor="anonymizeData" className="ml-2 text-sm text-gray-700">
                å€‹äººæƒ…å ±ã‚’åŒ¿ååŒ–ã™ã‚‹
              </label>
            </div>
          </div>

          <div className="flex space-x-3 pt-4">
            <button
              type="button"
              onClick={onClose}
              className="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"
            >
              ã‚­ãƒ£ãƒ³ã‚»ãƒ«
            </button>
            <button
              type="submit"
              className="flex-1 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600"
            >
              ä½œæˆ
            </button>
          </div>
        </form>
      </div>
    </div>
  );
};
```

**å®Œäº†æ¡ä»¶**: æ—¢å­˜ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒä½œæˆã§ãã€å…¨æ©Ÿèƒ½ãŒçµ±åˆã•ã‚Œã¦å‹•ä½œã™ã‚‹ã“ã¨

#### âœ… å®Œäº†æ¡ä»¶
1. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé¸æŠç”»é¢ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãƒ»æ¤œç´¢ãŒå‹•ä½œã™ã‚‹
2. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§è©³ç´°ç¢ºèªãƒ»ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãŒå¯èƒ½
3. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ»ã‚¿ã‚¹ã‚¯ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹
4. æ—¢å­˜ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆåŒ–ãŒå¯èƒ½
5. æ¥­ç•Œåˆ¥ãƒ»ç”¨é€”åˆ¥ã®åˆ†é¡ã‚·ã‚¹ãƒ†ãƒ ãŒæ©Ÿèƒ½ã™ã‚‹

---

### ã‚¿ã‚¹ã‚¯ 2.2: è²¡å‹™ãƒªã‚¹ã‚¯è‡ªå‹•ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ 
**æœŸé–“**: 6å–¶æ¥­æ—¥  
**å·¥æ•°**: 6æ—¥  
**æ‹…å½“**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ + ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢  

#### ğŸ“‹ è¦ä»¶å®šç¾©
**æ©Ÿèƒ½è¦ä»¶**:
1. LTVåˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
2. è²¡å‹™ãƒªã‚¹ã‚¯ã‚¢ãƒ©ãƒ¼ãƒˆã‚·ã‚¹ãƒ†ãƒ 
3. åç›Šäºˆæ¸¬ã‚°ãƒ©ãƒ•
4. é¡§å®¢ã‚»ã‚°ãƒ¡ãƒ³ãƒˆè‡ªå‹•åˆ†æ

**éæ©Ÿèƒ½è¦ä»¶**:
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–: 1æ™‚é–“é–“éš”
- äºˆæ¸¬ç²¾åº¦: 85%ä»¥ä¸Š
- ã‚¢ãƒ©ãƒ¼ãƒˆé€šçŸ¥: 1åˆ†ä»¥å†…

#### ğŸ—ï¸ å®Ÿè£…è©³ç´°

##### Day 1-2: LTVåˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
**ä½œæ¥­å†…å®¹**:
```typescript
// /src/app/financial-analytics/page.tsx (æ–°è¦)
// /src/hooks/useFinancialAnalytics.ts (æ–°è¦)
// /src/components/charts/LTVAnalysisChart.tsx (æ–°è¦)

const useFinancialAnalytics = () => {
  const [ltvData, setLtvData] = useState(null);
  const [riskAlerts, setRiskAlerts] = useState([]);
  const [revenueProjection, setRevenueProjection] = useState(null);

  const fetchLTVAnalysis = useCallback(async () => {
    const response = await fetch('/api/ltv-analysis');
    const data = await response.json();
    setLtvData(data);
  }, []);

  const fetchFinancialRisks = useCallback(async () => {
    const response = await fetch('/api/financial-risk');
    const data = await response.json();
    setRiskAlerts(data.risks || []);
  }, []);

  const fetchRevenueProjection = useCallback(async () => {
    const response = await fetch('/api/revenue-prediction');
    const data = await response.json();
    setRevenueProjection(data);
  }, []);

  return {
    ltvData,
    riskAlerts,
    revenueProjection,
    fetchLTVAnalysis,
    fetchFinancialRisks,
    fetchRevenueProjection
  };
};

const LTVAnalysisChart: React.FC = () => {
  const { ltvData } = useFinancialAnalytics();

  if (!ltvData) return <div className="animate-pulse bg-gray-200 h-64 rounded"></div>;

  const chartData = {
    labels: ltvData.segments?.map(segment => segment.name) || [],
    datasets: [{
      label: 'Customer LTV (Â¥)',
      data: ltvData.segments?.map(segment => segment.averageLTV) || [],
      backgroundColor: [
        'rgba(59, 130, 246, 0.8)',
        'rgba(16, 185, 129, 0.8)',
        'rgba(245, 158, 11, 0.8)',
        'rgba(239, 68, 68, 0.8)'
      ]
    }]
  };

  return (
    <div className="bg-white p-6 rounded-lg shadow-md">
      <h3 className="text-lg font-semibold mb-4">ğŸ’° é¡§å®¢LTVåˆ†æ</h3>
      
      <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <div>
          <Doughnut data={chartData} options={{
            responsive: true,
            plugins: {
              legend: { position: 'bottom' }
            }
          }} />
        </div>
        
        <div className="space-y-4">
          <div className="text-center">
            <div className="text-3xl font-bold text-green-600">
              Â¥{ltvData.totalLTV?.toLocaleString() || 0}
            </div>
            <div className="text-sm text-gray-600">ç·LTV</div>
          </div>
          
          {ltvData.segments?.map((segment, index) => (
            <div key={index} className="flex justify-between items-center p-3 bg-gray-50 rounded">
              <span className="font-medium">{segment.name}</span>
              <div className="text-right">
                <div className="font-bold">Â¥{segment.averageLTV?.toLocaleString()}</div>
                <div className="text-sm text-gray-500">{segment.customerCount}é¡§å®¢</div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </div>
  );
};
```

**å®Œäº†æ¡ä»¶**: LTVåˆ†æãŒå¯è¦–åŒ–ã•ã‚Œã€é¡§å®¢ã‚»ã‚°ãƒ¡ãƒ³ãƒˆåˆ¥ã®åˆ†æãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨

##### Day 3-4: è²¡å‹™ãƒªã‚¹ã‚¯ã‚¢ãƒ©ãƒ¼ãƒˆã‚·ã‚¹ãƒ†ãƒ ãƒ»åç›Šäºˆæ¸¬ã‚°ãƒ©ãƒ•
**ä½œæ¥­å†…å®¹**:
```typescript
// /src/components/alerts/FinancialRiskAlerts.tsx
const FinancialRiskAlerts: React.FC = () => {
  const { riskAlerts } = useFinancialAnalytics();
  const [dismissedAlerts, setDismissedAlerts] = useState(new Set());

  const getRiskLevelColor = (level: string) => {
    switch (level) {
      case 'CRITICAL': return 'border-red-500 bg-red-50 text-red-800';
      case 'HIGH': return 'border-orange-500 bg-orange-50 text-orange-800';
      case 'MEDIUM': return 'border-yellow-500 bg-yellow-50 text-yellow-800';
      default: return 'border-blue-500 bg-blue-50 text-blue-800';
    }
  };

  const getRiskIcon = (level: string) => {
    switch (level) {
      case 'CRITICAL': return 'ğŸš¨';
      case 'HIGH': return 'âš ï¸';
      case 'MEDIUM': return 'âš¡';
      default: return 'â„¹ï¸';
    }
  };

  const handleDismiss = (alertId: string) => {
    setDismissedAlerts(prev => new Set([...prev, alertId]));
  };

  const activeAlerts = riskAlerts.filter(alert => !dismissedAlerts.has(alert.id));

  return (
    <div className="space-y-4">
      <h3 className="text-lg font-semibold">ğŸš¨ è²¡å‹™ãƒªã‚¹ã‚¯ã‚¢ãƒ©ãƒ¼ãƒˆ</h3>
      
      {activeAlerts.length > 0 ? (
        activeAlerts.map(alert => (
          <div key={alert.id} className={`border-l-4 p-4 rounded-lg ${getRiskLevelColor(alert.level)}`}>
            <div className="flex items-start justify-between">
              <div className="flex items-start">
                <span className="text-2xl mr-3">{getRiskIcon(alert.level)}</span>
                <div>
                  <h4 className="font-semibold">{alert.title}</h4>
                  <p className="text-sm mt-1">{alert.description}</p>
                  
                  {alert.metrics && (
                    <div className="mt-2 space-y-1">
                      {Object.entries(alert.metrics).map(([key, value]) => (
                        <div key={key} className="text-xs">
                          <span className="font-medium">{key}:</span> {value}
                        </div>
                      ))}
                    </div>
                  )}
                  
                  {alert.recommendations && (
                    <div className="mt-3">
                      <h5 className="font-medium text-sm">æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³:</h5>
                      <ul className="list-disc list-inside text-xs mt-1 space-y-1">
                        {alert.recommendations.map((rec, index) => (
                          <li key={index}>{rec}</li>
                        ))}
                      </ul>
                    </div>
                  )}
                  
                  <div className="text-xs text-gray-500 mt-2">
                    æ¤œå‡ºæ™‚åˆ»: {format(new Date(alert.detectedAt), 'yyyy/MM/dd HH:mm')}
                  </div>
                </div>
              </div>
              
              <button
                onClick={() => handleDismiss(alert.id)}
                className="text-gray-400 hover:text-gray-600 ml-4"
              >
                âœ•
              </button>
            </div>
          </div>
        ))
      ) : (
        <div className="text-center py-8 text-gray-500">
          ç¾åœ¨ã€è²¡å‹™ãƒªã‚¹ã‚¯ã‚¢ãƒ©ãƒ¼ãƒˆã¯ã‚ã‚Šã¾ã›ã‚“ ğŸ‰
        </div>
      )}
    </div>
  );
};

// /src/components/charts/RevenueProjectionChart.tsx
const RevenueProjectionChart: React.FC = () => {
  const { revenueProjection } = useFinancialAnalytics();

  if (!revenueProjection) return <div className="animate-pulse bg-gray-200 h-64 rounded"></div>;

  const chartData = {
    labels: revenueProjection.timeline?.map(item => item.month) || [],
    datasets: [{
      label: 'äºˆæ¸¬åç›Š',
      data: revenueProjection.timeline?.map(item => item.projected) || [],
      borderColor: 'rgb(59, 130, 246)',
      backgroundColor: 'rgba(59, 130, 246, 0.1)',
      tension: 0.4,
      fill: true
    }, {
      label: 'ä¿å®ˆçš„äºˆæ¸¬',
      data: revenueProjection.timeline?.map(item => item.conservative) || [],
      borderColor: 'rgb(107, 114, 128)',
      backgroundColor: 'rgba(107, 114, 128, 0.05)',
      borderDash: [5, 5],
      tension: 0.4,
      fill: false
    }, {
      label: 'æ¥½è¦³çš„äºˆæ¸¬',
      data: revenueProjection.timeline?.map(item => item.optimistic) || [],
      borderColor: 'rgb(16, 185, 129)',
      backgroundColor: 'rgba(16, 185, 129, 0.05)',
      borderDash: [2, 2],
      tension: 0.4,
      fill: false
    }]
  };

  return (
    <div className="bg-white p-6 rounded-lg shadow-md">
      <h3 className="text-lg font-semibold mb-4">ğŸ“ˆ åç›Šäºˆæ¸¬</h3>
      
      <Line data={chartData} options={{
        responsive: true,
        scales: {
          y: {
            beginAtZero: true,
            ticks: {
              callback: (value) => `Â¥${value.toLocaleString()}`
            }
          }
        },
        plugins: {
          legend: { position: 'top' },
          tooltip: {
            callbacks: {
              label: (context) => {
                return `${context.dataset.label}: Â¥${context.parsed.y.toLocaleString()}`;
              }
            }
          }
        }
      }} />
      
      <div className="mt-6 grid grid-cols-3 gap-4">
        <div className="text-center">
          <div className="text-2xl font-bold text-blue-600">
            Â¥{revenueProjection.nextQuarter?.toLocaleString() || 0}
          </div>
          <div className="text-sm text-gray-600">æ¥å››åŠæœŸäºˆæ¸¬</div>
        </div>
        <div className="text-center">
          <div className="text-2xl font-bold text-green-600">
            {revenueProjection.growthRate || 0}%
          </div>
          <div className="text-sm text-gray-600">æˆé•·ç‡</div>
        </div>
        <div className="text-center">
          <div className="text-2xl font-bold text-purple-600">
            {revenueProjection.confidence || 0}%
          </div>
          <div className="text-sm text-gray-600">äºˆæ¸¬ä¿¡é ¼åº¦</div>
        </div>
      </div>
    </div>
  );
};
```

**å®Œäº†æ¡ä»¶**: è²¡å‹™ãƒªã‚¹ã‚¯ã‚¢ãƒ©ãƒ¼ãƒˆãŒè¡¨ç¤ºã•ã‚Œã€åç›Šäºˆæ¸¬ã‚°ãƒ©ãƒ•ãŒå¯è¦–åŒ–ã•ã‚Œã‚‹ã“ã¨

##### Day 5-6: é¡§å®¢ã‚»ã‚°ãƒ¡ãƒ³ãƒˆè‡ªå‹•åˆ†æãƒ»çµ±åˆãƒ»ãƒ†ã‚¹ãƒˆ
**ä½œæ¥­å†…å®¹**:
```typescript
// /src/components/analytics/CustomerSegmentAnalysis.tsx
const CustomerSegmentAnalysis: React.FC = () => {
  const [segmentData, setSegmentData] = useState(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    const fetchSegmentData = async () => {
      try {
        const response = await fetch('/api/analytics/customer-segments');
        const data = await response.json();
        setSegmentData(data);
      } catch (error) {
        console.error('Failed to fetch segment data:', error);
      } finally {
        setLoading(false);
      }
    };

    fetchSegmentData();
  }, []);

  if (loading) return <div className="animate-pulse bg-gray-200 h-64 rounded"></div>;

  return (
    <div className="bg-white p-6 rounded-lg shadow-md">
      <h3 className="text-lg font-semibold mb-4">ğŸ‘¥ é¡§å®¢ã‚»ã‚°ãƒ¡ãƒ³ãƒˆåˆ†æ</h3>
      
      <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
        {/* ã‚»ã‚°ãƒ¡ãƒ³ãƒˆä¸€è¦§ */}
        <div className="space-y-4">
          {segmentData?.segments?.map((segment, index) => (
            <div key={index} className="border border-gray-200 rounded-lg p-4">
              <div className="flex items-center justify-between mb-2">
                <h4 className="font-medium">{segment.name}</h4>
                <span className="text-sm text-gray-500">
                  {segment.customerCount}é¡§å®¢
                </span>
              </div>
              
              <div className="grid grid-cols-2 gap-4 text-sm">
                <div>
                  <span className="text-gray-600">å¹³å‡LTV:</span>
                  <div className="font-bold text-green-600">
                    Â¥{segment.averageLTV?.toLocaleString()}
                  </div>
                </div>
                <div>
                  <span className="text-gray-600">å¹³å‡å–å¼•é¡:</span>
                  <div className="font-bold text-blue-600">
                    Â¥{segment.averageOrderValue?.toLocaleString()}
                  </div>
                </div>
                <div>
                  <span className="text-gray-600">ãƒªãƒ”ãƒ¼ãƒˆç‡:</span>
                  <div className="font-bold text-purple-600">
                    {segment.repeatRate}%
                  </div>
                </div>
                <div>
                  <span className="text-gray-600">ãƒãƒ£ãƒ¼ãƒ³ç‡:</span>
                  <div className="font-bold text-red-600">
                    {segment.churnRate}%
                  </div>
                </div>
              </div>

              <div className="mt-3">
                <span className="text-gray-600 text-sm">ç‰¹å¾´:</span>
                <div className="flex flex-wrap gap-1 mt-1">
                  {segment.characteristics?.slice(0, 3).map((char, charIndex) => (
                    <span key={charIndex} className="px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded">
                      {char}
                    </span>
                  ))}
                </div>
              </div>
            </div>
          ))}
        </div>

        {/* ã‚»ã‚°ãƒ¡ãƒ³ãƒˆåˆ†å¸ƒãƒãƒ£ãƒ¼ãƒˆ */}
        <div>
          <h4 className="font-medium mb-3">ã‚»ã‚°ãƒ¡ãƒ³ãƒˆåˆ†å¸ƒ</h4>
          {segmentData?.segments && (
            <Pie data={{
              labels: segmentData.segments.map(s => s.name),
              datasets: [{
                data: segmentData.segments.map(s => s.customerCount),
                backgroundColor: [
                  'rgba(59, 130, 246, 0.8)',
                  'rgba(16, 185, 129, 0.8)',
                  'rgba(245, 158, 11, 0.8)',
                  'rgba(239, 68, 68, 0.8)',
                  'rgba(139, 92, 246, 0.8)'
                ]
              }]
            }} options={{
              responsive: true,
              plugins: {
                legend: { position: 'bottom' }
              }
            }} />
          )}

          <div className="mt-4 space-y-2">
            <div className="text-center">
              <div className="text-2xl font-bold text-blue-600">
                {segmentData?.totalCustomers || 0}
              </div>
              <div className="text-sm text-gray-600">ç·é¡§å®¢æ•°</div>
            </div>
            
            <div className="grid grid-cols-2 gap-4 text-center text-sm">
              <div>
                <div className="font-bold text-green-600">
                  {segmentData?.highValueSegmentPercentage || 0}%
                </div>
                <div className="text-gray-600">é«˜ä¾¡å€¤é¡§å®¢</div>
              </div>
              <div>
                <div className="font-bold text-red-600">
                  {segmentData?.atRiskSegmentPercentage || 0}%
                </div>
                <div className="text-gray-600">ãƒªã‚¹ã‚¯é¡§å®¢</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};

// ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸çµ±åˆ
// /src/app/financial-analytics/page.tsx
const FinancialAnalyticsPage: React.FC = () => {
  const { 
    ltvData, 
    riskAlerts, 
    revenueProjection,
    fetchLTVAnalysis,
    fetchFinancialRisks,
    fetchRevenueProjection
  } = useFinancialAnalytics();

  useEffect(() => {
    // åˆæœŸãƒ‡ãƒ¼ã‚¿å–å¾—
    fetchLTVAnalysis();
    fetchFinancialRisks();
    fetchRevenueProjection();

    // å®šæœŸæ›´æ–°ï¼ˆ1æ™‚é–“é–“éš”ï¼‰
    const interval = setInterval(() => {
      fetchFinancialRisks(); // ãƒªã‚¹ã‚¯ã‚¢ãƒ©ãƒ¼ãƒˆã®ã¿ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°
    }, 60 * 60 * 1000);

    return () => clearInterval(interval);
  }, []);

  return (
    <div className="container mx-auto px-4 py-8">
      <div className="mb-8">
        <h1 className="text-3xl font-bold">ğŸ’° è²¡å‹™åˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>
        <p className="text-gray-600 mt-2">
          ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è²¡å‹™ç›£è¦–ãƒ»LTVåˆ†æãƒ»åç›Šäºˆæ¸¬ã‚·ã‚¹ãƒ†ãƒ 
        </p>
      </div>

      <div className="space-y-8">
        {/* ã‚¢ãƒ©ãƒ¼ãƒˆå„ªå…ˆè¡¨ç¤º */}
        {riskAlerts.length > 0 && (
          <FinancialRiskAlerts />
        )}

        {/* ãƒ¡ã‚¤ãƒ³åˆ†æã‚¨ãƒªã‚¢ */}
        <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
          <LTVAnalysisChart />
          <RevenueProjectionChart />
        </div>

        <CustomerSegmentAnalysis />

        {/* çµ±è¨ˆã‚µãƒãƒªãƒ¼ */}
        <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
          <div className="bg-white p-4 rounded-lg shadow-md text-center">
            <div className="text-2xl font-bold text-green-600">
              Â¥{ltvData?.totalLTV?.toLocaleString() || 0}
            </div>
            <div className="text-sm text-gray-600">ç·LTV</div>
          </div>
          <div className="bg-white p-4 rounded-lg shadow-md text-center">
            <div className="text-2xl font-bold text-blue-600">
              {revenueProjection?.growthRate || 0}%
            </div>
            <div className="text-sm text-gray-600">æˆé•·ç‡</div>
          </div>
          <div className="bg-white p-4 rounded-lg shadow-md text-center">
            <div className="text-2xl font-bold text-purple-600">
              {revenueProjection?.confidence || 0}%
            </div>
            <div className="text-sm text-gray-600">äºˆæ¸¬ç²¾åº¦</div>
          </div>
          <div className="bg-white p-4 rounded-lg shadow-md text-center">
            <div className={`text-2xl font-bold ${
              riskAlerts.length === 0 ? 'text-green-600' : 'text-red-600'
            }`}>
              {riskAlerts.length}
            </div>
            <div className="text-sm text-gray-600">ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¢ãƒ©ãƒ¼ãƒˆ</div>
          </div>
        </div>
      </div>

      <div className="mt-8 text-center">
        <Link href="/dashboard" className="text-blue-500 hover:underline">
          â† ãƒ¡ã‚¤ãƒ³ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«æˆ»ã‚‹
        </Link>
      </div>
    </div>
  );
};
```

**å®Œäº†æ¡ä»¶**: é¡§å®¢ã‚»ã‚°ãƒ¡ãƒ³ãƒˆåˆ†æãŒè¡¨ç¤ºã•ã‚Œã€å…¨è²¡å‹™åˆ†ææ©Ÿèƒ½ãŒçµ±åˆã•ã‚Œã¦å‹•ä½œã™ã‚‹ã“ã¨

#### âœ… å®Œäº†æ¡ä»¶
1. LTVåˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãŒå‹•ä½œã—ã€é¡§å®¢ä¾¡å€¤ãŒå¯è¦–åŒ–ã•ã‚Œã‚‹
2. è²¡å‹™ãƒªã‚¹ã‚¯ã‚¢ãƒ©ãƒ¼ãƒˆãŒãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è¡¨ç¤ºã•ã‚Œã‚‹
3. åç›Šäºˆæ¸¬ã‚°ãƒ©ãƒ•ãŒ3ãƒ‘ã‚¿ãƒ¼ãƒ³ã§è¡¨ç¤ºã•ã‚Œã‚‹
4. é¡§å®¢ã‚»ã‚°ãƒ¡ãƒ³ãƒˆè‡ªå‹•åˆ†æãŒæ©Ÿèƒ½ã™ã‚‹
5. 1æ™‚é–“é–“éš”ã§ã®è‡ªå‹•æ›´æ–°ãŒå‹•ä½œã™ã‚‹

---

### ã‚¿ã‚¹ã‚¯ 2.3: MBTIå€‹äººæœ€é©åŒ–ã‚·ã‚¹ãƒ†ãƒ 
**æœŸé–“**: 5å–¶æ¥­æ—¥  
**å·¥æ•°**: 5æ—¥  
**æ‹…å½“**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢  

#### ğŸ“‹ è¦ä»¶å®šç¾©
**æ©Ÿèƒ½è¦ä»¶**:
1. å€‹äººMBTIåˆ†æãƒšãƒ¼ã‚¸
2. ãƒãƒ¼ãƒ ç›¸æ€§åˆ†ææ©Ÿèƒ½
3. æœ€é©ã‚¿ã‚¹ã‚¯æ¨å¥¨ã‚·ã‚¹ãƒ†ãƒ 
4. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹äºˆæ¸¬æ©Ÿèƒ½

**éæ©Ÿèƒ½è¦ä»¶**:
- MBTIåˆ†æç²¾åº¦: 90%ä»¥ä¸Š
- æ¨å¥¨ã‚¿ã‚¹ã‚¯é©åˆç‡: 85%ä»¥ä¸Š
- ç›¸æ€§åˆ†æé€Ÿåº¦: 3ç§’ä»¥å†…

#### ğŸ—ï¸ å®Ÿè£…è©³ç´°

##### Day 1-2: å€‹äººMBTIåˆ†æãƒšãƒ¼ã‚¸
**ä½œæ¥­å†…å®¹**:
```typescript
// /src/app/mbti/individual/[userId]/page.tsx (æ–°è¦)
// /src/hooks/useMBTIAnalysis.ts (æ–°è¦)
// /src/components/mbti/PersonalityProfile.tsx (æ–°è¦)

const useMBTIAnalysis = (userId?: string) => {
  const [mbtiData, setMbtiData] = useState(null);
  const [teamCompatibility, setTeamCompatibility] = useState(null);
  const [taskRecommendations, setTaskRecommendations] = useState([]);

  const fetchIndividualMBTI = useCallback(async (targetUserId: string) => {
    const response = await fetch(`/api/mbti/individual/${targetUserId}`);
    const data = await response.json();
    setMbtiData(data);
  }, []);

  const fetchTeamCompatibility = useCallback(async (userIds: string[]) => {
    const response = await fetch('/api/mbti/compatibility', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ userIds })
    });
    const data = await response.json();
    setTeamCompatibility(data);
  }, []);

  const fetchTaskRecommendations = useCallback(async (targetUserId: string) => {
    const response = await fetch(`/api/mbti/task-recommendations?userId=${targetUserId}`);
    const data = await response.json();
    setTaskRecommendations(data.recommendations || []);
  }, []);

  return {
    mbtiData,
    teamCompatibility,
    taskRecommendations,
    fetchIndividualMBTI,
    fetchTeamCompatibility,
    fetchTaskRecommendations
  };
};

const PersonalityProfile: React.FC<{ userId: string }> = ({ userId }) => {
  const { mbtiData } = useMBTIAnalysis();

  useEffect(() => {
    fetchIndividualMBTI(userId);
  }, [userId]);

  if (!mbtiData) {
    return <div className="animate-pulse bg-gray-200 h-64 rounded"></div>;
  }

  const mbtiColors = {
    'E': 'bg-red-100 text-red-800',
    'I': 'bg-blue-100 text-blue-800',
    'S': 'bg-green-100 text-green-800',
    'N': 'bg-purple-100 text-purple-800',
    'T': 'bg-yellow-100 text-yellow-800',
    'F': 'bg-pink-100 text-pink-800',
    'J': 'bg-indigo-100 text-indigo-800',
    'P': 'bg-orange-100 text-orange-800'
  };

  const getStrengthColor = (score: number) => {
    if (score >= 80) return 'text-green-600';
    if (score >= 60) return 'text-yellow-600';
    return 'text-red-600';
  };

  return (
    <div className="space-y-6">
      {/* MBTI ã‚¿ã‚¤ãƒ—è¡¨ç¤º */}
      <div className="bg-white p-6 rounded-lg shadow-md">
        <div className="flex items-center justify-between mb-4">
          <h3 className="text-xl font-semibold">ğŸ§  MBTIæ€§æ ¼ã‚¿ã‚¤ãƒ—</h3>
          <div className="text-sm text-gray-500">
            ä¿¡é ¼åº¦: {mbtiData.confidenceScore}%
          </div>
        </div>

        <div className="text-center mb-6">
          <div className="text-6xl font-bold text-blue-600 mb-2">
            {mbtiData.mbtiType}
          </div>
          <div className="text-xl text-gray-800 font-medium">
            {mbtiData.typeName}
          </div>
          <div className="text-gray-600 mt-2">
            {mbtiData.typeDescription}
          </div>
        </div>

        {/* 4æ¬¡å…ƒåˆ†æ */}
        <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
          {mbtiData.dimensions?.map((dimension, index) => (
            <div key={index} className="text-center">
              <div className={`inline-block px-3 py-2 rounded-full text-sm font-medium ${
                mbtiColors[dimension.dominant]
              }`}>
                {dimension.dominant}
              </div>
              <div className="text-xs text-gray-600 mt-1">
                {dimension.percentage}%
              </div>
              <div className="text-xs text-gray-500">
                {dimension.label}
              </div>
            </div>
          ))}
        </div>
      </div>

      {/* å¼·ã¿ãƒ»ç‰¹å¾´åˆ†æ */}
      <div className="bg-white p-6 rounded-lg shadow-md">
        <h3 className="text-lg font-semibold mb-4">ğŸ’ª å¼·ã¿ãƒ»ç‰¹å¾´åˆ†æ</h3>
        
        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <h4 className="font-medium mb-3">ä¸»è¦ãªå¼·ã¿</h4>
            <div className="space-y-2">
              {mbtiData.strengths?.map((strength, index) => (
                <div key={index} className="flex items-center justify-between">
                  <span className="text-sm">{strength.name}</span>
                  <div className="flex items-center">
                    <div className="w-16 bg-gray-200 rounded-full h-2 mr-2">
                      <div 
                        className={`h-2 rounded-full ${
                          strength.score >= 80 ? 'bg-green-500' :
                          strength.score >= 60 ? 'bg-yellow-500' : 'bg-red-500'
                        }`}
                        style={{ width: `${strength.score}%` }}
                      ></div>
                    </div>
                    <span className={`text-xs font-medium ${getStrengthColor(strength.score)}`}>
                      {strength.score}%
                    </span>
                  </div>
                </div>
              ))}
            </div>
          </div>

          <div>
            <h4 className="font-medium mb-3">æ”¹å–„é ˜åŸŸ</h4>
            <div className="space-y-2">
              {mbtiData.developmentAreas?.map((area, index) => (
                <div key={index} className="flex items-center justify-between">
                  <span className="text-sm">{area.name}</span>
                  <div className="flex items-center">
                    <div className="w-16 bg-gray-200 rounded-full h-2 mr-2">
                      <div 
                        className="h-2 rounded-full bg-blue-500"
                        style={{ width: `${area.improvementPotential}%` }}
                      ></div>
                    </div>
                    <span className="text-xs font-medium text-blue-600">
                      {area.improvementPotential}%
                    </span>
                  </div>
                </div>
              ))}
            </div>
          </div>
        </div>

        {/* é©æ€§è·å‹™ */}
        <div className="mt-6">
          <h4 className="font-medium mb-3">é©æ€§è·å‹™ãƒ»å½¹å‰²</h4>
          <div className="flex flex-wrap gap-2">
            {mbtiData.suitableRoles?.map((role, index) => (
              <span key={index} className="px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-full">
                {role}
              </span>
            ))}
          </div>
        </div>
      </div>

      {/* ä½œæ¥­ã‚¹ã‚¿ã‚¤ãƒ«åˆ†æ */}
      <div className="bg-white p-6 rounded-lg shadow-md">
        <h3 className="text-lg font-semibold mb-4">âš™ï¸ ä½œæ¥­ã‚¹ã‚¿ã‚¤ãƒ«åˆ†æ</h3>
        
        <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
          <div>
            <h4 className="font-medium mb-3">ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³</h4>
            <div className="space-y-2 text-sm">
              <div className="flex justify-between">
                <span>ç›´æ¥æ€§</span>
                <span className="font-medium">{mbtiData.workStyle?.communication?.directness}%</span>
              </div>
              <div className="flex justify-between">
                <span>è©³ç´°å¿—å‘</span>
                <span className="font-medium">{mbtiData.workStyle?.communication?.detailOriented}%</span>
              </div>
              <div className="flex justify-between">
                <span>æ„Ÿæƒ…è¡¨ç¾</span>
                <span className="font-medium">{mbtiData.workStyle?.communication?.emotional}%</span>
              </div>
            </div>
          </div>

          <div>
            <h4 className="font-medium mb-3">æ„æ€æ±ºå®š</h4>
            <div className="space-y-2 text-sm">
              <div className="flex justify-between">
                <span>è«–ç†æ€§</span>
                <span className="font-medium">{mbtiData.workStyle?.decisionMaking?.logical}%</span>
              </div>
              <div className="flex justify-between">
                <span>é€Ÿåº¦</span>
                <span className="font-medium">{mbtiData.workStyle?.decisionMaking?.speed}%</span>
              </div>
              <div className="flex justify-between">
                <span>ãƒªã‚¹ã‚¯è¨±å®¹åº¦</span>
                <span className="font-medium">{mbtiData.workStyle?.decisionMaking?.riskTolerance}%</span>
              </div>
            </div>
          </div>

          <div>
            <h4 className="font-medium mb-3">ã‚¹ãƒˆãƒ¬ã‚¹ç®¡ç†</h4>
            <div className="space-y-2 text-sm">
              <div className="flex justify-between">
                <span>ã‚¹ãƒˆãƒ¬ã‚¹è€æ€§</span>
                <span className="font-medium">{mbtiData.workStyle?.stress?.tolerance}%</span>
              </div>
              <div className="flex justify-between">
                <span>å›å¾©é€Ÿåº¦</span>
                <span className="font-medium">{mbtiData.workStyle?.stress?.recovery}%</span>
              </div>
              <div className="flex justify-between">
                <span>ã‚µãƒãƒ¼ãƒˆå¿…è¦åº¦</span>
                <span className="font-medium">{mbtiData.workStyle?.stress?.supportNeed}%</span>
              </div>
            </div>
          </div>
        </div>

        <div className="mt-4 p-3 bg-blue-50 rounded">
          <h5 className="font-medium text-blue-800 mb-2">æœ€é©ãªä½œæ¥­ç’°å¢ƒ</h5>
          <p className="text-sm text-blue-700">{mbtiData.optimalWorkEnvironment}</p>
        </div>
      </div>
    </div>
  );
};

// /src/app/mbti/individual/[userId]/page.tsx
const IndividualMBTIPage: React.FC<{ params: { userId: string } }> = ({ params }) => {
  return (
    <div className="container mx-auto px-4 py-8">
      <div className="mb-8">
        <h1 className="text-3xl font-bold">ğŸ§  å€‹äººMBTIåˆ†æ</h1>
        <p className="text-gray-600 mt-2">
          AIåˆ†æã«ã‚ˆã‚‹è©³ç´°ãªæ€§æ ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¨æœ€é©åŒ–ææ¡ˆ
        </p>
      </div>

      <PersonalityProfile userId={params.userId} />

      <div className="mt-8 text-center">
        <Link href="/mbti" className="text-blue-500 hover:underline">
          â† MBTIåˆ†æã«æˆ»ã‚‹
        </Link>
      </div>
    </div>
  );
};
```

**å®Œäº†æ¡ä»¶**: å€‹äººMBTIåˆ†æãƒšãƒ¼ã‚¸ã§è©³ç´°ãªãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨

##### Day 3-4: ãƒãƒ¼ãƒ ç›¸æ€§åˆ†æãƒ»æœ€é©ã‚¿ã‚¹ã‚¯æ¨å¥¨ã‚·ã‚¹ãƒ†ãƒ 
**ä½œæ¥­å†…å®¹**:
```typescript
// /src/components/mbti/TeamCompatibilityAnalysis.tsx
const TeamCompatibilityAnalysis: React.FC<{ userIds: string[] }> = ({ userIds }) => {
  const { teamCompatibility, fetchTeamCompatibility } = useMBTIAnalysis();

  useEffect(() => {
    if (userIds.length >= 2) {
      fetchTeamCompatibility(userIds);
    }
  }, [userIds]);

  if (!teamCompatibility) {
    return <div className="animate-pulse bg-gray-200 h-64 rounded"></div>;
  }

  const getCompatibilityColor = (score: number) => {
    if (score >= 80) return 'text-green-600 bg-green-100';
    if (score >= 60) return 'text-yellow-600 bg-yellow-100';
    return 'text-red-600 bg-red-100';
  };

  return (
    <div className="bg-white p-6 rounded-lg shadow-md">
      <h3 className="text-lg font-semibold mb-4">ğŸ¤ ãƒãƒ¼ãƒ ç›¸æ€§åˆ†æ</h3>
      
      {/* ç·åˆç›¸æ€§ã‚¹ã‚³ã‚¢ */}
      <div className="text-center mb-6">
        <div className={`text-4xl font-bold mb-2 ${getCompatibilityColor(teamCompatibility.overallScore).split(' ')[0]}`}>
          {teamCompatibility.overallScore}%
        </div>
        <div className="text-gray-600">ç·åˆç›¸æ€§ã‚¹ã‚³ã‚¢</div>
        <div className={`inline-block px-3 py-1 rounded-full text-sm font-medium mt-2 ${getCompatibilityColor(teamCompatibility.overallScore)}`}>
          {teamCompatibility.overallScore >= 80 ? 'å„ªç§€' :
           teamCompatibility.overallScore >= 60 ? 'è‰¯å¥½' : 'è¦æ”¹å–„'}
        </div>
      </div>

      {/* ç›¸æ€§ãƒãƒˆãƒªãƒƒã‚¯ã‚¹ */}
      <div className="mb-6">
        <h4 className="font-medium mb-3">ãƒ¡ãƒ³ãƒãƒ¼é–“ç›¸æ€§ãƒãƒˆãƒªãƒƒã‚¯ã‚¹</h4>
        <div className="overflow-x-auto">
          <table className="w-full text-sm">
            <thead>
              <tr>
                <th className="text-left p-2"></th>
                {teamCompatibility.members?.map((member, index) => (
                  <th key={index} className="text-center p-2 font-medium">
                    {member.name}
                  </th>
                ))}
              </tr>
            </thead>
            <tbody>
              {teamCompatibility.members?.map((member, rowIndex) => (
                <tr key={rowIndex}>
                  <td className="p-2 font-medium">{member.name}</td>
                  {teamCompatibility.members.map((otherMember, colIndex) => {
                    if (rowIndex === colIndex) {
                      return <td key={colIndex} className="text-center p-2">-</td>;
                    }
                    const compatibility = teamCompatibility.matrix?.[rowIndex]?.[colIndex] || 0;
                    return (
                      <td key={colIndex} className="text-center p-2">
                        <span className={`inline-block w-8 h-8 rounded text-xs leading-8 font-medium ${getCompatibilityColor(compatibility)}`}>
                          {compatibility}
                        </span>
                      </td>
                    );
                  })}
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      </div>

      {/* ç›¸æ€§åˆ†æè©³ç´° */}
      <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <h4 className="font-medium mb-3">å¼·ã¿ãƒ»ã‚·ãƒŠã‚¸ãƒ¼</h4>
          <div className="space-y-2">
            {teamCompatibility.strengths?.map((strength, index) => (
              <div key={index} className="flex items-start">
                <CheckCircle className="w-4 h-4 text-green-500 mr-2 mt-0.5" />
                <div>
                  <div className="font-medium text-sm">{strength.title}</div>
                  <div className="text-xs text-gray-600">{strength.description}</div>
                </div>
              </div>
            ))}
          </div>
        </div>

        <div>
          <h4 className="font-medium mb-3">èª²é¡Œãƒ»æ”¹å–„ç‚¹</h4>
          <div className="space-y-2">
            {teamCompatibility.challenges?.map((challenge, index) => (
              <div key={index} className="flex items-start">
                <AlertTriangle className="w-4 h-4 text-yellow-500 mr-2 mt-0.5" />
                <div>
                  <div className="font-medium text-sm">{challenge.title}</div>
                  <div className="text-xs text-gray-600">{challenge.description}</div>
                  {challenge.solution && (
                    <div className="text-xs text-blue-600 mt-1">
                      ğŸ’¡ {challenge.solution}
                    </div>
                  )}
                </div>
              </div>
            ))}
          </div>
        </div>
      </div>

      {/* å½¹å‰²åˆ†æ‹…ææ¡ˆ */}
      <div className="mt-6">
        <h4 className="font-medium mb-3">æœ€é©å½¹å‰²åˆ†æ‹…</h4>
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
          {teamCompatibility.roleAssignments?.map((assignment, index) => (
            <div key={index} className="border border-gray-200 rounded-lg p-3">
              <div className="font-medium text-sm">{assignment.role}</div>
              <div className="text-xs text-gray-600 mt-1">{assignment.member}</div>
              <div className="text-xs text-blue-600 mt-1">
                é©åˆåº¦: {assignment.fitScore}%
              </div>
            </div>
          ))}
        </div>
      </div>
    </div>
  );
};

// /src/components/mbti/TaskRecommendations.tsx
const TaskRecommendations: React.FC<{ userId: string }> = ({ userId }) => {
  const { taskRecommendations, fetchTaskRecommendations } = useMBTIAnalysis();

  useEffect(() => {
    fetchTaskRecommendations(userId);
  }, [userId]);

  const getPriorityColor = (priority: string) => {
    switch (priority) {
      case 'HIGH': return 'text-red-600 bg-red-100';
      case 'MEDIUM': return 'text-yellow-600 bg-yellow-100';
      default: return 'text-green-600 bg-green-100';
    }
  };

  const getFitColor = (score: number) => {
    if (score >= 90) return 'text-green-600';
    if (score >= 70) return 'text-yellow-600';
    return 'text-red-600';
  };

  return (
    <div className="bg-white p-6 rounded-lg shadow-md">
      <h3 className="text-lg font-semibold mb-4">ğŸ¯ æœ€é©ã‚¿ã‚¹ã‚¯æ¨å¥¨</h3>
      
      {taskRecommendations.length > 0 ? (
        <div className="space-y-4">
          {taskRecommendations.map((task, index) => (
            <div key={index} className="border border-gray-200 rounded-lg p-4">
              <div className="flex items-start justify-between">
                <div className="flex-1">
                  <div className="flex items-center mb-2">
                    <h4 className="font-medium">{task.title}</h4>
                    <span className={`ml-2 px-2 py-1 rounded text-xs font-medium ${getPriorityColor(task.priority)}`}>
                      {task.priority}
                    </span>
                  </div>
                  
                  <p className="text-sm text-gray-600 mb-3">{task.description}</p>
                  
                  <div className="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                    <div>
                      <span className="text-gray-500">æ¨å®šå·¥æ•°:</span>
                      <span className="font-medium ml-1">{task.estimatedHours}æ™‚é–“</span>
                    </div>
                    <div>
                      <span className="text-gray-500">é›£æ˜“åº¦:</span>
                      <span className="font-medium ml-1">{task.difficulty}/5</span>
                    </div>
                    <div>
                      <span className="text-gray-500">æœŸé™:</span>
                      <span className="font-medium ml-1">
                        {format(new Date(task.dueDate), 'MM/dd')}
                      </span>
                    </div>
                  </div>

                  <div className="mt-3">
                    <span className="text-gray-500 text-sm">é©æ€§ç†ç”±:</span>
                    <div className="text-sm text-blue-700 mt-1">
                      {task.reasonForRecommendation}
                    </div>
                  </div>

                  {task.requiredSkills && (
                    <div className="mt-3">
                      <span className="text-gray-500 text-sm">å¿…è¦ã‚¹ã‚­ãƒ«:</span>
                      <div className="flex flex-wrap gap-1 mt-1">
                        {task.requiredSkills.map((skill, skillIndex) => (
                          <span key={skillIndex} className="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded">
                            {skill}
                          </span>
                        ))}
                      </div>
                    </div>
                  )}
                </div>
                
                <div className="ml-4 text-center">
                  <div className={`text-2xl font-bold ${getFitColor(task.personalityFit)}`}>
                    {task.personalityFit}%
                  </div>
                  <div className="text-xs text-gray-500">é©åˆåº¦</div>
                  
                  <button className="mt-2 bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600">
                    ã‚¢ã‚µã‚¤ãƒ³
                  </button>
                </div>
              </div>
            </div>
          ))}
        </div>
      ) : (
        <div className="text-center py-8 text-gray-500">
          ç¾åœ¨ã€æ¨å¥¨ã‚¿ã‚¹ã‚¯ã¯ã‚ã‚Šã¾ã›ã‚“
        </div>
      )}
    </div>
  );
};
```

**å®Œäº†æ¡ä»¶**: ãƒãƒ¼ãƒ ç›¸æ€§åˆ†æã¨æœ€é©ã‚¿ã‚¹ã‚¯æ¨å¥¨ãŒæ©Ÿèƒ½ã™ã‚‹ã“ã¨

##### Day 5: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹äºˆæ¸¬ãƒ»çµ±åˆãƒ»ãƒ†ã‚¹ãƒˆ
**ä½œæ¥­å†…å®¹**:
```typescript
// /src/components/mbti/PerformancePrediction.tsx
const PerformancePrediction: React.FC<{ userId: string; projectId?: string }> = ({ 
  userId, 
  projectId 
}) => {
  const [performanceData, setPerformanceData] = useState(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    const fetchPerformanceData = async () => {
      try {
        const response = await fetch(
          `/api/mbti/performance-prediction?userId=${userId}${projectId ? `&projectId=${projectId}` : ''}`
        );
        const data = await response.json();
        setPerformanceData(data);
      } catch (error) {
        console.error('Failed to fetch performance data:', error);
      } finally {
        setLoading(false);
      }
    };

    fetchPerformanceData();
  }, [userId, projectId]);

  if (loading) return <div className="animate-pulse bg-gray-200 h-64 rounded"></div>;

  const getPerformanceColor = (score: number) => {
    if (score >= 80) return 'text-green-600';
    if (score >= 60) return 'text-yellow-600';
    return 'text-red-600';
  };

  return (
    <div className="bg-white p-6 rounded-lg shadow-md">
      <h3 className="text-lg font-semibold mb-4">ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹äºˆæ¸¬</h3>
      
      <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
        <div className="text-center">
          <div className={`text-3xl font-bold ${getPerformanceColor(performanceData?.overallScore || 0)}`}>
            {performanceData?.overallScore || 0}%
          </div>
          <div className="text-sm text-gray-600">ç·åˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹äºˆæ¸¬</div>
        </div>
        
        <div className="text-center">
          <div className={`text-3xl font-bold ${getPerformanceColor(performanceData?.productivityScore || 0)}`}>
            {performanceData?.productivityScore || 0}%
          </div>
          <div className="text-sm text-gray-600">ç”Ÿç”£æ€§äºˆæ¸¬</div>
        </div>
        
        <div className="text-center">
          <div className={`text-3xl font-bold ${getPerformanceColor(performanceData?.satisfactionScore || 0)}`}>
            {performanceData?.satisfactionScore || 0}%
          </div>
          <div className="text-sm text-gray-600">æº€è¶³åº¦äºˆæ¸¬</div>
        </div>
      </div>

      {/* è©³ç´°åˆ†æ */}
      <div className="space-y-4">
        <div>
          <h4 className="font-medium mb-3">ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¦å› åˆ†æ</h4>
          <div className="space-y-2">
            {performanceData?.factors?.map((factor, index) => (
              <div key={index} className="flex items-center justify-between">
                <span className="text-sm">{factor.name}</span>
                <div className="flex items-center">
                  <div className="w-24 bg-gray-200 rounded-full h-2 mr-2">
                    <div 
                      className={`h-2 rounded-full ${
                        factor.impact >= 0.7 ? 'bg-green-500' :
                        factor.impact >= 0.4 ? 'bg-yellow-500' : 'bg-red-500'
                      }`}
                      style={{ width: `${factor.impact * 100}%` }}
                    ></div>
                  </div>
                  <span className="text-xs font-medium w-8">
                    {Math.round(factor.impact * 100)}%
                  </span>
                </div>
              </div>
            ))}
          </div>
        </div>

        <div>
          <h4 className="font-medium mb-3">æ™‚ç³»åˆ—ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹äºˆæ¸¬</h4>
          {performanceData?.timeline && (
            <Line data={{
              labels: performanceData.timeline.map(item => item.week),
              datasets: [{
                label: 'ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹äºˆæ¸¬',
                data: performanceData.timeline.map(item => item.predictedPerformance),
                borderColor: 'rgb(59, 130, 246)',
                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                tension: 0.4,
                fill: true
              }, {
                label: 'ã‚¹ãƒˆãƒ¬ã‚¹ãƒ¬ãƒ™ãƒ«',
                data: performanceData.timeline.map(item => item.stressLevel),
                borderColor: 'rgb(239, 68, 68)',
                backgroundColor: 'rgba(239, 68, 68, 0.1)',
                borderDash: [5, 5],
                tension: 0.4
              }]
            }} options={{
              responsive: true,
              scales: {
                y: {
                  beginAtZero: true,
                  max: 100,
                  ticks: {
                    callback: (value) => `${value}%`
                  }
                }
              },
              plugins: {
                legend: { position: 'bottom' }
              }
            }} />
          )}
        </div>

        <div>
          <h4 className="font-medium mb-3">æœ€é©åŒ–ææ¡ˆ</h4>
          <div className="space-y-3">
            {performanceData?.optimizationSuggestions?.map((suggestion, index) => (
              <div key={index} className="border border-blue-200 rounded-lg p-3">
                <div className="flex items-start justify-between">
                  <div className="flex-1">
                    <h5 className="font-medium text-blue-800">{suggestion.title}</h5>
                    <p className="text-sm text-gray-600 mt-1">{suggestion.description}</p>
                    <div className="text-xs text-blue-600 mt-2">
                      æœŸå¾…åŠ¹æœ: +{suggestion.expectedImprovement}%
                    </div>
                  </div>
                  <button className="bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600 ml-4">
                    é©ç”¨
                  </button>
                </div>
              </div>
            ))}
          </div>
        </div>
      </div>
    </div>
  );
};

// ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸çµ±åˆ
// /src/app/mbti/page.tsx
const MBTIAnalysisPage: React.FC = () => {
  const [selectedUsers, setSelectedUsers] = useState<string[]>([]);
  const [users, setUsers] = useState([]);

  useEffect(() => {
    const fetchUsers = async () => {
      const response = await fetch('/api/users');
      const data = await response.json();
      setUsers(data.users || []);
    };
    fetchUsers();
  }, []);

  return (
    <div className="container mx-auto px-4 py-8">
      <div className="mb-8">
        <h1 className="text-3xl font-bold">ğŸ§  MBTIåˆ†æãƒ»æœ€é©åŒ–ã‚·ã‚¹ãƒ†ãƒ </h1>
        <p className="text-gray-600 mt-2">
          AIé§†å‹•ã«ã‚ˆã‚‹æ€§æ ¼åˆ†æã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
        </p>
      </div>

      {/* ãƒ¦ãƒ¼ã‚¶ãƒ¼é¸æŠ */}
      <div className="bg-white p-6 rounded-lg shadow-md mb-8">
        <h3 className="text-lg font-semibold mb-4">ğŸ‘¥ åˆ†æå¯¾è±¡é¸æŠ</h3>
        <div className="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
          {users.map(user => (
            <div key={user.id} className="border border-gray-200 rounded-lg p-3">
              <div className="flex items-center">
                <input
                  type="checkbox"
                  id={`user-${user.id}`}
                  checked={selectedUsers.includes(user.id)}
                  onChange={(e) => {
                    if (e.target.checked) {
                      setSelectedUsers(prev => [...prev, user.id]);
                    } else {
                      setSelectedUsers(prev => prev.filter(id => id !== user.id));
                    }
                  }}
                  className="rounded border-gray-300 text-blue-600 focus:ring-blue-500"
                />
                <label htmlFor={`user-${user.id}`} className="ml-2 text-sm font-medium">
                  {user.name}
                </label>
              </div>
              {user.mbtiType && (
                <div className="text-xs text-gray-500 mt-1">
                  {user.mbtiType}
                </div>
              )}
            </div>
          ))}
        </div>
      </div>

      {/* åˆ†æçµæœè¡¨ç¤º */}
      <div className="space-y-8">
        {selectedUsers.length === 1 && (
          <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <PersonalityProfile userId={selectedUsers[0]} />
            <div className="space-y-6">
              <TaskRecommendations userId={selectedUsers[0]} />
              <PerformancePrediction userId={selectedUsers[0]} />
            </div>
          </div>
        )}

        {selectedUsers.length >= 2 && (
          <TeamCompatibilityAnalysis userIds={selectedUsers} />
        )}

        {selectedUsers.length === 0 && (
          <div className="text-center py-12">
            <div className="text-gray-400 text-6xl mb-4">ğŸ§ </div>
            <h3 className="text-lg font-medium text-gray-900 mb-2">
              åˆ†æå¯¾è±¡ã‚’é¸æŠã—ã¦ãã ã•ã„
            </h3>
            <p className="text-gray-500">
              1äººé¸æŠã§å€‹äººåˆ†æã€2äººä»¥ä¸Šã§ãƒãƒ¼ãƒ åˆ†æãŒè¡¨ç¤ºã•ã‚Œã¾ã™
            </p>
          </div>
        )}
      </div>
    </div>
  );
};
```

**å®Œäº†æ¡ä»¶**: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹äºˆæ¸¬ãŒè¡¨ç¤ºã•ã‚Œã€å…¨MBTIæ©Ÿèƒ½ãŒçµ±åˆã•ã‚Œã¦å‹•ä½œã™ã‚‹ã“ã¨

#### âœ… å®Œäº†æ¡ä»¶
1. å€‹äººMBTIåˆ†æãƒšãƒ¼ã‚¸ã§è©³ç´°ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¡¨ç¤ºã•ã‚Œã‚‹
2. ãƒãƒ¼ãƒ ç›¸æ€§åˆ†æã§ç›¸æ€§ã‚¹ã‚³ã‚¢ã¨ãƒãƒˆãƒªãƒƒã‚¯ã‚¹ãŒè¡¨ç¤ºã•ã‚Œã‚‹
3. æœ€é©ã‚¿ã‚¹ã‚¯æ¨å¥¨ã‚·ã‚¹ãƒ†ãƒ ãŒå‹•ä½œã™ã‚‹
4. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹äºˆæ¸¬æ©Ÿèƒ½ãŒå‹•ä½œã™ã‚‹
5. å…¨æ©Ÿèƒ½ãŒçµ±åˆã•ã‚ŒãŸãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ãŒå‹•ä½œã™ã‚‹

---

## ğŸ“Š Phase 2 å®Œäº†åŸºæº–

### æ©Ÿèƒ½å®Œæˆãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
- [ ] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé©ç”¨ã‚·ã‚¹ãƒ†ãƒ å®Œæˆï¼ˆ4ã¤ã®æ©Ÿèƒ½ã™ã¹ã¦å‹•ä½œï¼‰
- [ ] è²¡å‹™ãƒªã‚¹ã‚¯è‡ªå‹•ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ å®Œæˆï¼ˆ4ã¤ã®æ©Ÿèƒ½ã™ã¹ã¦å‹•ä½œï¼‰
- [ ] MBTIå€‹äººæœ€é©åŒ–ã‚·ã‚¹ãƒ†ãƒ å®Œæˆï¼ˆ4ã¤ã®æ©Ÿèƒ½ã™ã¹ã¦å‹•ä½œï¼‰
- [ ] æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã¨ã®çµ±åˆç¢ºèª
- [ ] APIæ¥ç¶šãƒ»ãƒ‡ãƒ¼ã‚¿åŒæœŸç¢ºèª
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆåˆæ ¼ï¼ˆ3ç§’ä»¥å†…è¡¨ç¤ºï¼‰

### å“è³ªä¿è¨¼ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
- [ ] å˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿæ–½ãƒ»åˆæ ¼ï¼ˆ85%ä»¥ä¸Šã‚«ãƒãƒ¬ãƒƒã‚¸ï¼‰
- [ ] çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿæ–½ãƒ»åˆæ ¼
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆå®Ÿæ–½ãƒ»åˆæ ¼
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆå®Ÿæ–½ãƒ»åˆæ ¼
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆå®Ÿæ–½ãƒ»åˆæ ¼

### ãƒªãƒªãƒ¼ã‚¹æº–å‚™ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
- [ ] ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤
- [ ] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
- [ ] ç›£è¦–ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šå®Œäº†
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰ãƒ»ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°è³‡æ–™ä½œæˆ
- [ ] ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ»å¾©æ—§æ‰‹é †ç¢ºèª

### æˆåŠŸæŒ‡æ¨™é”æˆç¢ºèª
- [ ] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç«‹ã¡ä¸Šã’åŠ¹ç‡500%å‘ä¸Šç¢ºèª
- [ ] è²¡å‹™ãƒªã‚¹ã‚¯æ¤œçŸ¥ç‡95%ä»¥ä¸Šé”æˆ
- [ ] ãƒãƒ¼ãƒ ç”Ÿç”£æ€§300%å‘ä¸Šç¢ºèª
- [ ] ã‚·ã‚¹ãƒ†ãƒ å®Œæˆåº¦70%é”æˆï¼ˆ77/109 APIæ´»ç”¨ï¼‰

---

**Phase 2å®Œäº†å¾Œã®Next Steps**:
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯åé›†ãƒ»åˆ†æ
2. Phase 3å®Ÿè£…è¨ˆç”»ã®æœ€çµ‚èª¿æ•´
3. ã‚·ã‚¹ãƒ†ãƒ è² è·ãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
4. æ–°æ©Ÿèƒ½ã®åŠ¹æœæ¸¬å®šãƒ»æ”¹å–„

**ç·Šæ€¥æ™‚å¯¾å¿œ**:
- æ©Ÿèƒ½ä¸å…·åˆæ™‚ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †å®Œå‚™
- 24æ™‚é–“ã‚µãƒãƒ¼ãƒˆä½“åˆ¶æ•´å‚™
- ã‚¨ãƒ©ãƒ¼ç›£è¦–ãƒ»è‡ªå‹•ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š
- ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ãƒ»ä¿®å¾©æ©Ÿèƒ½

**Phase 3ã¸ã®æº–å‚™**:
- [ ] é«˜åº¦çµ±åˆæ©Ÿèƒ½ã®è¦ä»¶è©³ç´°åŒ–
- [ ] ãƒªã‚½ãƒ¼ã‚¹é…åˆ†è¨ˆç”»æ›´æ–°
- [ ] ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºæ©Ÿèƒ½ã®ä»•æ§˜ç¢ºå®š
- [ ] ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£è¨­è¨ˆãƒ¬ãƒ“ãƒ¥ãƒ¼