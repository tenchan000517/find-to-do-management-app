# ã‚¦ã‚¨ã‚¤ãƒˆãƒ»ãƒªã‚½ãƒ¼ã‚¹ãƒ™ãƒ¼ã‚¹è‡ªå‹•ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°å®Ÿè£…ãƒ•ã‚§ãƒ¼ã‚ºè¨ˆç”»

**ä½œæˆæ—¥**: 2025å¹´6æœˆ30æ—¥  
**ãƒ•ã‚§ãƒ¼ã‚ºå**: æ¬¡ä¸–ä»£ã‚¦ã‚¨ã‚¤ãƒˆãƒ»ãƒªã‚½ãƒ¼ã‚¹ãƒ™ãƒ¼ã‚¹è‡ªå‹•ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°å®Ÿè£…  
**æœŸé–“**: 4-5æ—¥  
**å„ªå…ˆåº¦**: CRITICAL  
**å‰ææ¡ä»¶**: åŸºæœ¬è‡ªå‹•ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°å®Œäº†æ¸ˆã¿

---

## ğŸ¯ ãƒ•ã‚§ãƒ¼ã‚ºç›®æ¨™

### **æœ€çµ‚ç›®æ¨™**
æ™‚é–“æŒ‡å®šã§ã¯ãªãã€Œ**ã‚¦ã‚¨ã‚¤ãƒˆãƒ»ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†**ã€ã«ã‚ˆã‚‹çœŸã«å®Ÿç”¨çš„ãªè‡ªå‹•ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ æ§‹ç¯‰

### **ç¾åœ¨ã®å•é¡Œ**
- æ™‚é–“ãƒ™ãƒ¼ã‚¹ã®é…ç½®ã¯å­¦ç”Ÿãƒ»å¤šå¿™ãªç¤¾ä¼šäººã«ã¯ä¸é©åˆ‡
- å€‹äººã®ãƒªã‚½ãƒ¼ã‚¹åˆ¶ç´„ãƒ»ç”Ÿæ´»ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç„¡è¦–
- å°†æ¥ã®ã‚¿ã‚¹ã‚¯é€¼è¿«ã‚’äºˆæ¸¬ã—ãªã„è¿‘è¦–çœ¼çš„é…ç½®
- å€‹äººäºˆå®šã¨ã®çµ±åˆä¸è¶³

### **å®Œäº†å¾Œã®çŠ¶æ…‹**
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ¥ãƒªã‚½ãƒ¼ã‚¹ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«**ã«ã‚ˆã‚‹åˆ¶ç´„ç®¡ç†
- **ã‚¿ã‚¹ã‚¯ã‚¦ã‚¨ã‚¤ãƒˆè¦‹ç©ã‚‚ã‚Š**ã«ã‚ˆã‚‹ç¾å®Ÿçš„é…ç½®
- **å…ˆèª­ã¿é…ç½®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ **ã«ã‚ˆã‚‹å°†æ¥ç ´ç¶»å›é¿
- **å€‹äººäºˆå®šçµ±åˆ**ã«ã‚ˆã‚‹å®Ÿç”Ÿæ´»å¯¾å¿œ

---

## ğŸ“‹ ãƒ•ã‚§ãƒ¼ã‚ºåˆ†å‰²

### **Phase A: ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«è¨­è¨ˆ** (1æ—¥)

#### **A1: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒªã‚½ãƒ¼ã‚¹ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«è¨­è¨ˆ**
- **ãƒ•ã‚¡ã‚¤ãƒ«**: `/src/types/resource-profile.ts`
- **å®Ÿè£…å†…å®¹**:
  ```typescript
  interface UserResourceProfile {
    id: string;
    userId: string;
    userType: 'student' | 'employee' | 'freelancer' | 'entrepreneur';
    commitmentRatio: number; // 0.1-1.0 (åˆ©ç”¨å¯èƒ½æ™‚é–“ã®å‰²åˆ)
    dailyCapacity: {
      lightTaskSlots: number;    // è»½ã„ã‚¿ã‚¹ã‚¯å¯èƒ½æ•°/æ—¥
      heavyTaskSlots: number;    // é‡ã„ã‚¿ã‚¹ã‚¯å¯èƒ½æ•°/æ—¥
      totalWeightLimit: number;  // 1æ—¥ã®ç·ã‚¦ã‚¨ã‚¤ãƒˆä¸Šé™
      continuousWorkHours: number; // é€£ç¶šä½œæ¥­å¯èƒ½æ™‚é–“
    };
    timeConstraints: {
      unavailableHours: string[];     // åˆ©ç”¨ä¸å¯æ™‚é–“å¸¯
      preferredWorkHours: string[];   // æ¨å¥¨ä½œæ¥­æ™‚é–“å¸¯
      maxWorkingHours: number;        // 1æ—¥æœ€å¤§ä½œæ¥­æ™‚é–“
    };
    workingPattern: {
      productiveHours: string[];      // ç”Ÿç”£æ€§é«˜ã„æ™‚é–“å¸¯
      focusCapacity: 'low' | 'medium' | 'high';  // é›†ä¸­åŠ›
      multitaskingAbility: number;   // ãƒãƒ«ãƒã‚¿ã‚¹ã‚¯èƒ½åŠ› 0-1
    };
    personalConstraints: {
      schoolSchedule?: string[];      // å­¦ç”Ÿ: æˆæ¥­æ™‚é–“
      workingHours?: string[];        // ç¤¾ä¼šäºº: å‹¤å‹™æ™‚é–“  
      familyTime?: string[];          // å®¶æ—æ™‚é–“
      personalCommitments?: string[]; // å€‹äººçš„ç´„æŸ
    };
    preferences: {
      earlyStart: boolean;            // æ—©æœä½œæ¥­å¯èƒ½
      lateWork: boolean;              // å¤œé–“ä½œæ¥­å¯èƒ½
      weekendWork: boolean;           // é€±æœ«ä½œæ¥­å¯èƒ½
      breakFrequency: 'low' | 'medium' | 'high'; // ä¼‘æ†©é »åº¦
    };
    createdAt: string;
    updatedAt: string;
  }
  ```

#### **A2: ã‚¿ã‚¹ã‚¯ã‚¦ã‚¨ã‚¤ãƒˆãƒ»è¦‹ç©ã‚‚ã‚Šã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ**
- **ãƒ•ã‚¡ã‚¤ãƒ«**: `/src/types/task-weight.ts`
- **å®Ÿè£…å†…å®¹**:
  ```typescript
  interface TaskWeightProfile {
    id: string;
    taskId: string;
    estimatedWeight: number;        // 1-10 (è»½ä½œæ¥­ï½é‡ä½œæ¥­)
    estimatedDuration: number;      // äºˆæƒ³ä½œæ¥­æ™‚é–“(åˆ†)
    estimatedDays: number;          // å®Œäº†ã¾ã§ã®äºˆæƒ³æ—¥æ•°
    complexityLevel: 'simple' | 'medium' | 'complex' | 'expert';
    canSplit: boolean;              // åˆ†å‰²å®Ÿè¡Œå¯èƒ½
    splitMinimumDuration: number;   // åˆ†å‰²æ™‚ã®æœ€å°ä½œæ¥­æ™‚é–“
    dependsOnTasks: string[];       // ä¾å­˜ã‚¿ã‚¹ã‚¯ID
    blocksOtherTasks: string[];     // ã“ã®ã‚¿ã‚¹ã‚¯ãŒå®Œäº†ã‚’é˜»ã‚€ã‚¿ã‚¹ã‚¯
    urgencyScore: number;           // 1-10 (ç·Šæ€¥åº¦)
    importanceScore: number;        // 1-10 (é‡è¦åº¦)
    energyRequirement: 'low' | 'medium' | 'high'; // å¿…è¦ã‚¨ãƒãƒ«ã‚®ãƒ¼
    creativityRequirement: 'low' | 'medium' | 'high'; // å‰µé€ æ€§è¦æ±‚
    focusRequirement: 'low' | 'medium' | 'high';     // é›†ä¸­åŠ›è¦æ±‚
    collaborationNeeded: boolean;   // ä»–è€…ã¨ã®å”åŠ›å¿…è¦
    resourcesNeeded: string[];      // å¿…è¦ãƒªã‚½ãƒ¼ã‚¹
    optimalTimeOfDay: 'morning' | 'afternoon' | 'evening' | 'flexible';
    deadlineBuffer: number;         // ç· åˆ‡ãƒãƒƒãƒ•ã‚¡(æ—¥)
    riskLevel: 'low' | 'medium' | 'high'; // é…å»¶ãƒªã‚¹ã‚¯
    autoGeneratedFrom?: 'appointment' | 'project' | 'template'; // è‡ªå‹•ç”Ÿæˆå…ƒ
    createdAt: string;
    updatedAt: string;
  }
  ```

#### **A3: å…ˆèª­ã¿äºˆæ¸¬ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ**
- **ãƒ•ã‚¡ã‚¤ãƒ«**: `/src/types/prediction.ts`
- **å®Ÿè£…å†…å®¹**:
  ```typescript
  interface FuturePrediction {
    userId: string;
    predictionDate: string;
    weeklyCapacityPrediction: {
      week1: CapacityPrediction;
      week2: CapacityPrediction;
      week3: CapacityPrediction;
      week4: CapacityPrediction;
    };
    monthlyTrends: {
      expectedTaskIncrease: number;   // äºˆæƒ³ã‚¿ã‚¹ã‚¯å¢—åŠ ç‡
      seasonalFactors: number;        // å­£ç¯€è¦å› 
      personalEventImpact: number;    // å€‹äººã‚¤ãƒ™ãƒ³ãƒˆå½±éŸ¿
    };
    riskAlerts: {
      overloadRisk: 'low' | 'medium' | 'high';
      burnoutRisk: 'low' | 'medium' | 'high';
      deadlineMissRisk: 'low' | 'medium' | 'high';
    };
    recommendations: string[];
    calculatedAt: string;
  }

  interface CapacityPrediction {
    availableCapacity: number;      // åˆ©ç”¨å¯èƒ½å®¹é‡%
    scheduledWeight: number;        // æ—¢å®šã‚¦ã‚¨ã‚¤ãƒˆ
    flexibleWeight: number;         // èª¿æ•´å¯èƒ½ã‚¦ã‚¨ã‚¤ãƒˆ
    riskDays: string[];            // ãƒªã‚¹ã‚¯ã®é«˜ã„æ—¥
    recommendedActions: string[];   // æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
  }
  ```

### **Phase B: ã‚³ã‚¢ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å®Ÿè£…** (2æ—¥)

#### **B1: ãƒªã‚½ãƒ¼ã‚¹åˆ¶ç´„ã‚¨ãƒ³ã‚¸ãƒ³å®Ÿè£…**
- **ãƒ•ã‚¡ã‚¤ãƒ«**: `/src/lib/scheduling/resource-constraint-engine.ts`
- **æ©Ÿèƒ½**:
  - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒªã‚½ãƒ¼ã‚¹ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«è§£æ
  - å€‹äººäºˆå®šã¨ã®è¡çªæ¤œçŸ¥
  - åˆ¶ç´„é•åãƒã‚§ãƒƒã‚¯
  - åˆ©ç”¨å¯èƒ½æ™‚é–“æ è¨ˆç®—

#### **B2: ã‚¦ã‚¨ã‚¤ãƒˆãƒ™ãƒ¼ã‚¹é…ç½®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å®Ÿè£…**
- **ãƒ•ã‚¡ã‚¤ãƒ«**: `/src/lib/scheduling/weight-based-scheduler.ts`
- **æ©Ÿèƒ½**:
  - ã‚¿ã‚¹ã‚¯ã‚¦ã‚¨ã‚¤ãƒˆè§£æ
  - æœ€é©é…ç½®è¨ˆç®—
  - åˆ†å‰²ã‚¿ã‚¹ã‚¯ç®¡ç†
  - ä¾å­˜é–¢ä¿‚å‡¦ç†

#### **B3: å…ˆèª­ã¿äºˆæ¸¬ã‚¨ãƒ³ã‚¸ãƒ³å®Ÿè£…**
- **ãƒ•ã‚¡ã‚¤ãƒ«**: `/src/lib/scheduling/future-prediction-engine.ts`
- **æ©Ÿèƒ½**:
  - å°†æ¥å®¹é‡äºˆæ¸¬
  - ãƒ‘ãƒ„ãƒ‘ãƒ„æœŸé–“æ¤œçŸ¥
  - å‰å€’ã—æ¨å¥¨
  - ãƒªã‚¹ã‚¯ã‚¢ãƒ©ãƒ¼ãƒˆç”Ÿæˆ

### **Phase C: APIçµ±åˆãƒ»UIå®Ÿè£…** (1æ—¥)

#### **C1: æ–°APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…**
- **ãƒ•ã‚¡ã‚¤ãƒ«**: `/src/app/api/ai/resource-schedule/route.ts`
- **æ©Ÿèƒ½**:
  - ãƒªã‚½ãƒ¼ã‚¹ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«è€ƒæ…®
  - ã‚¦ã‚¨ã‚¤ãƒˆãƒ™ãƒ¼ã‚¹ç”Ÿæˆ
  - å€‹äººäºˆå®šçµ±åˆ
  - å…ˆèª­ã¿é…ç½®

#### **C2: æ—¢å­˜UIæ‹¡å¼µ**
- **ãƒ•ã‚¡ã‚¤ãƒ«**: `/src/hooks/useResourceScheduleGenerator.ts`
- **æ©Ÿèƒ½**:
  - useScheduleGeneratorã®æ‹¡å¼µ
  - ãƒªã‚½ãƒ¼ã‚¹æƒ…å ±å–å¾—
  - ã‚¦ã‚¨ã‚¤ãƒˆè¡¨ç¤º
  - äºˆæ¸¬ã‚¢ãƒ©ãƒ¼ãƒˆè¡¨ç¤º

#### **C3: è¨­å®šUIå®Ÿè£…**
- **ãƒ•ã‚¡ã‚¤ãƒ«**: `/src/components/ResourceProfileSetup.tsx`
- **æ©Ÿèƒ½**:
  - ãƒªã‚½ãƒ¼ã‚¹ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«è¨­å®š
  - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚¤ãƒ—é¸æŠ
  - åˆ¶ç´„æ™‚é–“è¨­å®š
  - ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ©Ÿèƒ½

### **Phase D: å“è³ªä¿è¨¼ãƒ»æœ€é©åŒ–** (1æ—¥)

#### **D1: ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ç²¾åº¦å‘ä¸Š**
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ
- ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹å¯¾å¿œ
- ç²¾åº¦èª¿æ•´

#### **D2: çµ±åˆãƒ†ã‚¹ãƒˆ**
- å…¨ä½“ãƒ•ãƒ­ãƒ¼æ¤œè¨¼
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ

---

## ğŸ› ï¸ å®Ÿè£…è©³ç´°

### **Phase A1: UserResourceProfile è©³ç´°è¨­è¨ˆ**

```typescript
// /src/types/resource-profile.ts
export interface UserResourceProfile {
  id: string;
  userId: string;
  
  // åŸºæœ¬å±æ€§
  userType: 'student' | 'employee' | 'freelancer' | 'entrepreneur' | 'parent' | 'retiree';
  commitmentRatio: number; // 0.1-1.0
  
  // å®¹é‡è¨­å®š
  dailyCapacity: {
    lightTaskSlots: number;    // è»½ã‚¿ã‚¹ã‚¯: 1-10å€‹/æ—¥
    heavyTaskSlots: number;    // é‡ã‚¿ã‚¹ã‚¯: 0-3å€‹/æ—¥
    totalWeightLimit: number;  // ç·é‡é‡: 5-20/æ—¥
    continuousWorkHours: number; // é€£ç¶š: 1-8æ™‚é–“
  };
  
  // æ™‚é–“åˆ¶ç´„
  timeConstraints: {
    unavailableHours: string[];     // ["09:00-17:00"] (å‹¤å‹™æ™‚é–“)
    preferredWorkHours: string[];   // ["19:00-22:00"] (ä½œæ¥­æ™‚é–“)
    maxWorkingHours: number;        // æœ€å¤§8æ™‚é–“/æ—¥
  };
  
  // ä½œæ¥­ãƒ‘ã‚¿ãƒ¼ãƒ³
  workingPattern: {
    productiveHours: string[];      // ["09:00-11:00", "15:00-17:00"]
    focusCapacity: 'low' | 'medium' | 'high';
    multitaskingAbility: number;   // 0.0-1.0
  };
  
  // å€‹äººåˆ¶ç´„
  personalConstraints: {
    schoolSchedule?: string[];      // å­¦ç”Ÿå°‚ç”¨
    workingHours?: string[];        // ç¤¾ä¼šäººå°‚ç”¨
    familyTime?: string[];          // å®¶æ—æŒã¡å°‚ç”¨
    personalCommitments?: string[]; // ãã®ä»–ç´„æŸ
  };
  
  // è¨­å®š
  preferences: {
    earlyStart: boolean;            // æ—©æœä½œæ¥­OK
    lateWork: boolean;              // å¤œé–“ä½œæ¥­OK
    weekendWork: boolean;           // é€±æœ«ä½œæ¥­OK
    breakFrequency: 'low' | 'medium' | 'high';
  };
  
  createdAt: string;
  updatedAt: string;
}

// ãƒ—ãƒªã‚»ãƒƒãƒˆä¾‹
export const USER_TYPE_PRESETS: Record<UserResourceProfile['userType'], Partial<UserResourceProfile>> = {
  student: {
    commitmentRatio: 0.3,
    dailyCapacity: {
      lightTaskSlots: 3,
      heavyTaskSlots: 1,
      totalWeightLimit: 8,
      continuousWorkHours: 3
    },
    timeConstraints: {
      unavailableHours: ["09:00-16:00"], // æˆæ¥­æ™‚é–“
      preferredWorkHours: ["19:00-22:00"],
      maxWorkingHours: 4
    }
  },
  
  employee: {
    commitmentRatio: 0.6,
    dailyCapacity: {
      lightTaskSlots: 4,
      heavyTaskSlots: 2,
      totalWeightLimit: 12,
      continuousWorkHours: 4
    },
    timeConstraints: {
      unavailableHours: ["09:00-18:00"], // å‹¤å‹™æ™‚é–“
      preferredWorkHours: ["19:00-21:00"],
      maxWorkingHours: 3
    }
  },
  
  freelancer: {
    commitmentRatio: 0.8,
    dailyCapacity: {
      lightTaskSlots: 6,
      heavyTaskSlots: 3,
      totalWeightLimit: 18,
      continuousWorkHours: 6
    },
    timeConstraints: {
      unavailableHours: [],
      preferredWorkHours: ["09:00-18:00"],
      maxWorkingHours: 8
    }
  }
};
```

### **Phase B1: ãƒªã‚½ãƒ¼ã‚¹åˆ¶ç´„ã‚¨ãƒ³ã‚¸ãƒ³è©³ç´°**

```typescript
// /src/lib/scheduling/resource-constraint-engine.ts
import { UserResourceProfile } from '@/types/resource-profile';
import { PersonalSchedule } from '@/types/personal-schedule';
import { CalendarEvent } from '@/types';

interface TimeSlot {
  startTime: string;
  endTime: string;
  availableWeight: number;
  slotType: 'light' | 'heavy' | 'mixed';
  energyLevel: 'high' | 'medium' | 'low';
}

export class ResourceConstraintEngine {
  constructor(
    private userProfile: UserResourceProfile,
    private personalSchedules: PersonalSchedule[],
    private calendarEvents: CalendarEvent[]
  ) {}

  /**
   * æŒ‡å®šæ—¥ã®åˆ©ç”¨å¯èƒ½æ™‚é–“æ ã‚’è¨ˆç®—
   */
  calculateAvailableSlots(date: string): TimeSlot[] {
    const unavailableSlots = this.getUnavailableSlots(date);
    const workingHours = this.getWorkingHours();
    const productiveHours = this.userProfile.workingPattern.productiveHours;
    
    const availableSlots: TimeSlot[] = [];
    
    // 1æ™‚é–“å˜ä½ã§åˆ©ç”¨å¯èƒ½æ€§ã‚’ãƒã‚§ãƒƒã‚¯
    for (let hour = 0; hour < 24; hour++) {
      const timeSlot = this.formatHour(hour);
      
      if (this.isSlotAvailable(timeSlot, unavailableSlots, workingHours)) {
        const energyLevel = this.calculateEnergyLevel(timeSlot, productiveHours);
        const availableWeight = this.calculateAvailableWeight(energyLevel);
        
        availableSlots.push({
          startTime: timeSlot,
          endTime: this.formatHour(hour + 1),
          availableWeight,
          slotType: this.determineSlotType(availableWeight),
          energyLevel
        });
      }
    }
    
    return this.mergeConsecutiveSlots(availableSlots);
  }

  /**
   * ã‚¿ã‚¹ã‚¯ãŒæŒ‡å®šæ™‚é–“æ ã«é…ç½®å¯èƒ½ã‹ãƒã‚§ãƒƒã‚¯
   */
  canScheduleTask(
    task: TaskWithWeight,
    timeSlot: TimeSlot,
    date: string
  ): boolean {
    // ã‚¦ã‚¨ã‚¤ãƒˆåˆ¶ç´„ãƒã‚§ãƒƒã‚¯
    if (task.estimatedWeight > timeSlot.availableWeight) {
      return false;
    }
    
    // ã‚¨ãƒãƒ«ã‚®ãƒ¼è¦æ±‚ãƒã‚§ãƒƒã‚¯
    if (task.energyRequirement === 'high' && timeSlot.energyLevel === 'low') {
      return false;
    }
    
    // é›†ä¸­åŠ›è¦æ±‚ãƒã‚§ãƒƒã‚¯
    if (task.focusRequirement === 'high' && this.userProfile.workingPattern.focusCapacity === 'low') {
      return false;
    }
    
    // æœ€é©æ™‚é–“å¸¯ãƒã‚§ãƒƒã‚¯
    if (task.optimalTimeOfDay !== 'flexible') {
      if (!this.isOptimalTimeOfDay(timeSlot.startTime, task.optimalTimeOfDay)) {
        return false;
      }
    }
    
    return true;
  }

  /**
   * æ—¥æ¬¡å®¹é‡åˆ¶é™ãƒã‚§ãƒƒã‚¯
   */
  checkDailyCapacity(date: string, scheduledTasks: TaskWithWeight[]): {
    canAddLight: boolean;
    canAddHeavy: boolean;
    remainingWeight: number;
    utilizationRate: number;
  } {
    const dailyCapacity = this.userProfile.dailyCapacity;
    
    const lightTasksCount = scheduledTasks.filter(t => t.estimatedWeight <= 3).length;
    const heavyTasksCount = scheduledTasks.filter(t => t.estimatedWeight > 6).length;
    const totalWeight = scheduledTasks.reduce((sum, t) => sum + t.estimatedWeight, 0);
    
    return {
      canAddLight: lightTasksCount < dailyCapacity.lightTaskSlots,
      canAddHeavy: heavyTasksCount < dailyCapacity.heavyTaskSlots,
      remainingWeight: dailyCapacity.totalWeightLimit - totalWeight,
      utilizationRate: totalWeight / dailyCapacity.totalWeightLimit
    };
  }

  private getUnavailableSlots(date: string): string[] {
    const unavailable: string[] = [];
    
    // è¨­å®šã«ã‚ˆã‚‹åˆ©ç”¨ä¸å¯æ™‚é–“
    unavailable.push(...this.userProfile.timeConstraints.unavailableHours);
    
    // å€‹äººäºˆå®š
    const dayPersonalSchedules = this.personalSchedules.filter(ps => ps.date === date);
    dayPersonalSchedules.forEach(ps => {
      if (ps.endTime) {
        unavailable.push(`${ps.time}-${ps.endTime}`);
      } else {
        // çµ‚äº†æ™‚é–“æœªæŒ‡å®šã®å ´åˆã¯1æ™‚é–“ã¨ä»®å®š
        const endTime = this.addHours(ps.time, 1);
        unavailable.push(`${ps.time}-${endTime}`);
      }
    });
    
    // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆ
    const dayEvents = this.calendarEvents.filter(event => 
      new Date(event.startTime).toDateString() === new Date(date).toDateString()
    );
    dayEvents.forEach(event => {
      const startTime = new Date(event.startTime);
      const endTime = new Date(event.endTime || startTime.getTime() + 60 * 60 * 1000);
      unavailable.push(`${this.formatTime(startTime)}-${this.formatTime(endTime)}`);
    });
    
    return unavailable;
  }

  private getWorkingHours(): string[] {
    return this.userProfile.timeConstraints.preferredWorkHours;
  }

  private calculateEnergyLevel(timeSlot: string, productiveHours: string[]): 'high' | 'medium' | 'low' {
    const hour = parseInt(timeSlot.split(':')[0]);
    
    // ç”Ÿç”£æ€§é«˜ã„æ™‚é–“å¸¯
    if (productiveHours.some(ph => this.isTimeInRange(timeSlot, ph))) {
      return 'high';
    }
    
    // ä¸€èˆ¬çš„ãªã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³
    if (hour >= 9 && hour <= 11) return 'high';    // åˆå‰ä¸­
    if (hour >= 14 && hour <= 16) return 'medium'; // åˆå¾Œ
    if (hour >= 19 && hour <= 21) return 'medium'; // å¤œ
    
    return 'low';
  }

  private calculateAvailableWeight(energyLevel: 'high' | 'medium' | 'low'): number {
    const baseWeight = this.userProfile.dailyCapacity.totalWeightLimit / 8; // 8æ™‚é–“ã§é…åˆ†
    
    switch (energyLevel) {
      case 'high': return baseWeight * 1.5;
      case 'medium': return baseWeight;
      case 'low': return baseWeight * 0.5;
      default: return baseWeight;
    }
  }

  // ãã®ä»–ãƒ˜ãƒ«ãƒ‘ãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰...
}
```

---

## ğŸ“Š æˆåŠŸæŒ‡æ¨™

### **æ©Ÿèƒ½è¦ä»¶**
- âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ¥ãƒªã‚½ãƒ¼ã‚¹ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†
- âœ… ã‚¿ã‚¹ã‚¯ã‚¦ã‚¨ã‚¤ãƒˆè‡ªå‹•è¦‹ç©ã‚‚ã‚Š
- âœ… å€‹äººäºˆå®šã¨ã®å®Œå…¨çµ±åˆ
- âœ… å…ˆèª­ã¿é…ç½®ã«ã‚ˆã‚‹ç ´ç¶»å›é¿
- âœ… åˆ¶ç´„æ¡ä»¶ä¸‹ã§ã®æœ€é©é…ç½®

### **æŠ€è¡“è¦ä»¶**  
- âœ… å‹ãƒã‚§ãƒƒã‚¯ã‚¨ãƒ©ãƒ¼0ä»¶
- âœ… ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åŠ£åŒ–ãªã—
- âœ… ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ç²¾åº¦85%ä»¥ä¸Š
- âœ… ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“2ç§’ä»¥å†…

### **UXè¦ä»¶**
- âœ… è¨­å®š5åˆ†ä»¥å†…ã§å®Œäº†
- âœ… äºˆæ¸¬ç²¾åº¦ä½“æ„Ÿå‘ä¸Š
- âœ… ç ´ç¶»é˜²æ­¢åŠ¹æœå®Ÿæ„Ÿ
- âœ… å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚¤ãƒ—å¯¾å¿œ

---

## ğŸ¯ æœŸå¾…ã•ã‚Œã‚‹æˆæœ

### **ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¾¡å€¤**
- **çœŸã®å®Ÿç”¨æ€§**: å­¦ç”Ÿã‹ã‚‰çµŒå–¶è€…ã¾ã§å®Ÿéš›ã«ä½¿ãˆã‚‹
- **ç”Ÿæ´»é©å¿œæ€§**: å€‹äººã®åˆ¶ç´„ãƒ»ãƒ‘ã‚¿ãƒ¼ãƒ³ã«å®Œå…¨é©å¿œ
- **å…ˆèª­ã¿å®‰å¿ƒ**: å°†æ¥ã®ç ´ç¶»ã‚’äº‹å‰å›é¿
- **ã‚¹ãƒˆãƒ¬ã‚¹è»½æ¸›**: ãƒªã‚½ãƒ¼ã‚¹è¶…éã«ã‚ˆã‚‹ç ´ç¶»é˜²æ­¢

### **æŠ€è¡“çš„æˆæœ**
- **æ¬¡ä¸–ä»£ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ **: ã‚¦ã‚¨ã‚¤ãƒˆãƒ™ãƒ¼ã‚¹é…ç½®ã®ç¢ºç«‹
- **äºˆæ¸¬ã‚·ã‚¹ãƒ†ãƒ **: å°†æ¥å®¹é‡äºˆæ¸¬ã‚¨ãƒ³ã‚¸ãƒ³
- **åˆ¶ç´„å‡¦ç†**: è¤‡é›‘åˆ¶ç´„ä¸‹ã§ã®æœ€é©åŒ–
- **çµ±åˆã‚·ã‚¹ãƒ†ãƒ **: å…¨ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹çµ±åˆ

### **ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤**
- **å·®åˆ¥åŒ–**: ä»–ã«ãªã„å®Ÿç”¨çš„è‡ªå‹•ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°
- **æ‹¡å¼µæ€§**: ã‚ã‚‰ã‚†ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚¤ãƒ—ã«å¯¾å¿œ
- **ä¿¡é ¼æ€§**: ç ´ç¶»ã—ãªã„å®‰å¿ƒã‚·ã‚¹ãƒ†ãƒ 
- **ç¶™ç¶šåˆ©ç”¨**: å®Ÿéš›ã«å½¹ç«‹ã¤ãŸã‚é•·æœŸåˆ©ç”¨

---

## âš¡ å®Ÿè£…å„ªå…ˆé †ä½

### **Week 1: Phase A (ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«è¨­è¨ˆ)**
1. UserResourceProfile å‹å®šç¾©
2. TaskWeightProfile å‹å®šç¾©  
3. FuturePrediction å‹å®šç¾©
4. ãƒ—ãƒªã‚»ãƒƒãƒˆãƒ»ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

### **Week 2: Phase B (ã‚³ã‚¢ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ )**
1. ResourceConstraintEngine å®Ÿè£…
2. WeightBasedScheduler å®Ÿè£…
3. FuturePredictionEngine å®Ÿè£…
4. çµ±åˆãƒ†ã‚¹ãƒˆ

### **å®Œäº†åˆ¤å®šåŸºæº–**
- [ ] å­¦ç”Ÿãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã§å®Ÿç”¨çš„é…ç½®å‹•ä½œ
- [ ] ç¤¾ä¼šäººãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã§åˆ¶ç´„å›é¿å‹•ä½œ
- [ ] å…ˆèª­ã¿é…ç½®ã§ç ´ç¶»å›é¿å‹•ä½œ
- [ ] å€‹äººäºˆå®šçµ±åˆã§è¡çªå›é¿å‹•ä½œ
- [ ] å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚¤ãƒ—ã§ç²¾åº¦85%ä»¥ä¸Š

---

**ç®¡ç†è²¬ä»»è€…**: PM Level  
**å®Ÿè£…ãƒ–ãƒ©ãƒ³ãƒ**: `feature/resource-based-scheduling`  
**é–¢é€£æŠ€è¡“**: ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ è¨­è¨ˆ, äºˆæ¸¬ã‚·ã‚¹ãƒ†ãƒ , åˆ¶ç´„å‡¦ç†  
**é©æ–°æ€§**: æ¥­ç•Œåˆã®ã‚¦ã‚¨ã‚¤ãƒˆãƒ»ãƒªã‚½ãƒ¼ã‚¹ãƒ™ãƒ¼ã‚¹è‡ªå‹•ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°